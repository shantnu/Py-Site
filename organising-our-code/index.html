<!DOCTYPE html>
<html lang="en-US" class="no-js">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="http://gmpg.org/xfn/11">
		<script>(function(html){html.className = html.className.replace(/\bno-js\b/,'js')})(document.documentElement);</script>
<title>Organising Our Code &#8211; Python For Engineers</title>
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Python For Engineers &raquo; Feed" href="/feed/" />
<link rel="alternate" type="application/rss+xml" title="Python For Engineers &raquo; Comments Feed" href="/comments/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/pythonforengineers.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='crayon-css'  href='/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-github-css'  href='/wp-content/plugins/crayon-syntax-highlighter/themes/github/github.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='twentysixteen-fonts-css'  href='https://fonts.googleapis.com/css?family=Merriweather%3A400%2C700%2C900%2C400italic%2C700italic%2C900italic%7CMontserrat%3A400%2C700%7CInconsolata%3A400&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='genericons-css'  href='/wp-content/themes/twentysixteen/genericons/genericons.css?ver=3.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='twentysixteen-style-css'  href='/wp-content/themes/twentysixteen/style.css?ver=4.9.8' type='text/css' media='all' />
<!--[if lt IE 10]>
<link rel='stylesheet' id='twentysixteen-ie-css'  href='http://pythonforengineers.com/wp-content/themes/twentysixteen/css/ie.css?ver=20160816' type='text/css' media='all' />
<![endif]-->
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentysixteen-ie8-css'  href='http://pythonforengineers.com/wp-content/themes/twentysixteen/css/ie8.css?ver=20160816' type='text/css' media='all' />
<![endif]-->
<!--[if lt IE 8]>
<link rel='stylesheet' id='twentysixteen-ie7-css'  href='http://pythonforengineers.com/wp-content/themes/twentysixteen/css/ie7.css?ver=20160816' type='text/css' media='all' />
<![endif]-->
<script type='text/javascript' src='/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/pythonforengineers.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='http://pythonforengineers.com/wp-content/themes/twentysixteen/js/html5.js?ver=3.7.3'></script>
<![endif]-->
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 4.9.8" />
<link rel="canonical" href="/organising-our-code/" />
<link rel='shortlink' href='/?p=1758' />
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Forganising-our-code%2F" />
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Forganising-our-code%2F&#038;format=xml" />
</head>

<body class="page-template-default page page-id-1758">
<div id="page" class="site">
	<div class="site-inner">
		<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

		<header id="masthead" class="site-header" role="banner">
			<div class="site-header-main">
				<div class="site-branding">
					
											<p class="site-title"><a href="/" rel="home">Python For Engineers</a></p>
									</div><!-- .site-branding -->

									<button id="menu-toggle" class="menu-toggle">Menu</button>

					<div id="site-header-menu" class="site-header-menu">
													<nav id="site-navigation" class="main-navigation" role="navigation" aria-label="Primary Menu">
								<div class="menu-main-container"><ul id="menu-main" class="primary-menu"><li id="menu-item-52" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-52"><a href="/articles/">Articles</a></li>
<li id="menu-item-1533" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1533"><a href="/about/">About</a></li>
<li id="menu-item-35" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35"><a href="/contact/">Contact</a></li>
</ul></div>							</nav><!-- .main-navigation -->
						
											</div><!-- .site-header-menu -->
							</div><!-- .site-header-main -->

					</header><!-- .site-header -->

		<div id="content" class="site-content">

<div id="primary" class="content-area">
	<main id="main" class="site-main" role="main">
		
<article id="post-1758" class="post-1758 page type-page status-publish hentry">
	<header class="entry-header">
		<h1 class="entry-title">Organising Our Code</h1>	</header><!-- .entry-header -->

	
	<div class="entry-content">
		<h4><strong>Build a Twitter Analytics App</strong></h4>
<p style="padding-left: 30px;"><strong><a href="/build-a-twitter-analytics-app-using-python/"> 1 Introduction: Start Here</a></strong></p>
<p style="padding-left: 30px;"><strong><a href="/the-first-step-design-your-solution/">2 The First Step: Design Your Solution</a></strong></p>
<p style="padding-left: 30px;"><strong><a href="/in-which-i-rant-a-little/">3 In Which I Rant a Little</a></strong></p>
<p style="padding-left: 30px;"><a href="/twitter-analyser-my-design/"><strong>4  Design Solution</strong> </a></p>
<p style="padding-left: 30px;"><strong><a href="/writing-great-code/">5 Writing Great Code</a></strong></p>
<p style="padding-left: 30px;"><strong>6 Writing the Backend Twitter Server</strong></p>
<p style="padding-left: 60px;"><a href="/writing-the-code-in-small-parts-part-1-the-basic-app/"><strong>Writing the Code in Small Parts: Part 1, The Basic App</strong> </a></p>
<p style="padding-left: 60px;"><strong><a href="/part-2-adding-a-counter-to-exit/">Part 2: Adding a Counter to Exit</a></strong></p>
<p style="padding-left: 60px;"><strong><a href="/part-3-adding-language-and-retweet-count/">Part 3: Adding Language and Retweet Count</a></strong></p>
<p style="padding-left: 60px;"><strong><a href="/organising-our-code/">Part 4: Organising Our Code</a></strong></p>
<p style="padding-left: 30px;"><strong><a href="/adding-the-data-to-a-database/">7 Adding the Data to a Database</a></strong></p>
<p style="padding-left: 30px;"><a href="/testing-what-and-how-to-test/"><strong>8 <span class="trail-end">Testing: What and How to Test</span></strong></a></p>
<p style="padding-left: 60px;"><strong><a href="/testing-our-frontend/">8.1 Testing Our Frontend</a></strong></p>
<p style="padding-left: 60px;"><strong><a href="/testing-our-backend/">8.2 Testing Our Backend</a></strong></p>
<p style="padding-left: 30px;"><strong>9 Displaying our Data using the Flask Webserver</strong></p>
<p style="padding-left: 60px;"><strong><a href="/introduction-to-flask-for-python/">9.1 Introduction to Flask</a></strong></p>
<p style="padding-left: 60px;"><strong><a href="/adding-templates-to-our-flask-app/">9.2 Adding templates to our Flask app</a></strong></p>
<p style="padding-left: 60px;"><strong><a href="/displaying-our-tweets-in-the-flask-web-server/">9.3 Displaying our Tweets in the Flask Web Server</a></strong></p>
<p style="padding-left: 30px;"><strong><a href="/future-work-and-improvements/">10 Future Work and Improvements</a></strong></p>
<p>So, our code is starting to get messy, and we need to start organising it. There are two main tasks:</p>
<p>1 We have functions spread all over the place. Put them in a single class. This will make them easy to manage, and more importantly, easy to test.</p>
<p>2 At the moment, we are just printing the statistics. We need a way to pass them to the main function (so we can store, manipulate it etc).</p>
<p>Remember, global variables are evil. They cause unintended consequences, are hard to track, and make maintenance a nightmare. So how will we pass our data from the <em>Twitter streaming API</em> back to our main function? Remember the streaming API is real time, and we don&#8217;t want to do any processing (like writing to a database) in it.</p>
<p>Our solution will be to create an another class to store the statistics. This will make it easy to access it from multiple places, but still easy to test. This class will be light, as it will store the data as Python objects in memory, so it won&#8217;t take too much time to read/write from it (as it would from a database).</p>
<p>Let&#8217;s look at each of the above in detail.</p>
<p><strong>A Twitter Class</strong></p>
<p>First, let&#8217;s create a twitter class to encapsulate the multiple functions we have.  I&#8217;m going to simplify the code so we only have 2 functions- one to read streaming api, the other to read the trends, as that&#8217;s what our original use case required.</p>
<p>Let&#8217;s go over our class step by step. The code <a href="https://github.com/shantnu/TwitterAnalyser/blob/master/Part3/twit1.py">is here:</a></p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82efdba60001552383" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
class TwitterMain():
    def __init__(self, num_tweets_to_grab, retweet_count):
        self.auth = tweepy.OAuthHandler(cons_tok, cons_sec)
        self.auth.set_access_token(app_tok, app_sec)

        self.api = tweepy.API(self.auth)
        self.num_tweets_to_grab = num_tweets_to_grab
        self.retweet_count = retweet_count</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82efdba60001552383-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba60001552383-2">2</div><div class="crayon-num" data-line="crayon-5bcf82efdba60001552383-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba60001552383-4">4</div><div class="crayon-num" data-line="crayon-5bcf82efdba60001552383-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba60001552383-6">6</div><div class="crayon-num" data-line="crayon-5bcf82efdba60001552383-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba60001552383-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82efdba60001552383-1"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">TwitterMain</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba60001552383-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">num_tweets_to_grab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">retweet_count</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5bcf82efdba60001552383-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">auth</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tweepy</span><span class="crayon-sy">.</span><span class="crayon-e">OAuthHandler</span><span class="crayon-sy">(</span><span class="crayon-v">cons_tok</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cons_sec</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba60001552383-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">auth</span><span class="crayon-sy">.</span><span class="crayon-e">set_access_token</span><span class="crayon-sy">(</span><span class="crayon-v">app_tok</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">app_sec</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bcf82efdba60001552383-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba60001552383-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">api</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tweepy</span><span class="crayon-sy">.</span><span class="crayon-e">API</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">auth</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bcf82efdba60001552383-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">num_tweets_to_grab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">num_tweets_to_grab</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba60001552383-8"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">retweet_count</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">retweet_count</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p></p>
<p>We set up the authorisation in the initialisation function. We also setup the other variables we need, like <em>num_tweets_to_grab</em>.</p>
<p>After that, we bring in our existing functions:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82efdba6c894666354" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
    def get_streaming_data(self):
        twitter_stream = Stream(self.auth, twitter_listener(num_tweets_to_grab=self.num_tweets_to_grab, retweet_count = self.retweet_count))
        try:
            twitter_stream.sample()
        except Exception as e:
            print(e.__doc__)
    
    def get_trends(self):
        trends = self.api.trends_place(1)
        trend_data = []

        for trend in trends[0]["trends"]:
            #print(trend['name'])
            trend_tweets = []
            trend_tweets.append(trend['name'])
            tt = tweepy.Cursor(self.api.search, q = trend['name']).items(3)
         
            for t in tt:
                
                trend_tweets.append(t.text)
                #print(tweet_html)

            trend_data.append(tuple(trend_tweets))

        print(trend_data)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82efdba6c894666354-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba6c894666354-2">2</div><div class="crayon-num" data-line="crayon-5bcf82efdba6c894666354-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba6c894666354-4">4</div><div class="crayon-num" data-line="crayon-5bcf82efdba6c894666354-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba6c894666354-6">6</div><div class="crayon-num" data-line="crayon-5bcf82efdba6c894666354-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba6c894666354-8">8</div><div class="crayon-num" data-line="crayon-5bcf82efdba6c894666354-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba6c894666354-10">10</div><div class="crayon-num" data-line="crayon-5bcf82efdba6c894666354-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba6c894666354-12">12</div><div class="crayon-num" data-line="crayon-5bcf82efdba6c894666354-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba6c894666354-14">14</div><div class="crayon-num" data-line="crayon-5bcf82efdba6c894666354-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba6c894666354-16">16</div><div class="crayon-num" data-line="crayon-5bcf82efdba6c894666354-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba6c894666354-18">18</div><div class="crayon-num" data-line="crayon-5bcf82efdba6c894666354-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba6c894666354-20">20</div><div class="crayon-num" data-line="crayon-5bcf82efdba6c894666354-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba6c894666354-22">22</div><div class="crayon-num" data-line="crayon-5bcf82efdba6c894666354-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba6c894666354-24">24</div><div class="crayon-num" data-line="crayon-5bcf82efdba6c894666354-25">25</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82efdba6c894666354-1"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">get_streaming_data</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba6c894666354-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">twitter_stream</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Stream</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">auth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">twitter_listener</span><span class="crayon-sy">(</span><span class="crayon-v">num_tweets_to_grab</span><span class="crayon-o">=</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">num_tweets_to_grab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">retweet_count</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">retweet_count</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bcf82efdba6c894666354-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">try</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba6c894666354-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">twitter_stream</span><span class="crayon-sy">.</span><span class="crayon-e">sample</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bcf82efdba6c894666354-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">except </span><span class="crayon-e">Exception </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">e</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba6c894666354-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">e</span><span class="crayon-sy">.</span><span class="crayon-v">__doc__</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bcf82efdba6c894666354-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba6c894666354-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">get_trends</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5bcf82efdba6c894666354-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">trends</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">api</span><span class="crayon-sy">.</span><span class="crayon-e">trends_place</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba6c894666354-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">trend_data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5bcf82efdba6c894666354-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba6c894666354-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">trend </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">trends</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-s">"trends"</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5bcf82efdba6c894666354-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p">#print(trend['name'])</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba6c894666354-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">trend_tweets</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5bcf82efdba6c894666354-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">trend_tweets</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">trend</span><span class="crayon-sy">[</span><span class="crayon-s">'name'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba6c894666354-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">tt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tweepy</span><span class="crayon-sy">.</span><span class="crayon-e">Cursor</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">api</span><span class="crayon-sy">.</span><span class="crayon-v">search</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">q</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trend</span><span class="crayon-sy">[</span><span class="crayon-s">'name'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bcf82efdba6c894666354-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba6c894666354-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">t</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">tt</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5bcf82efdba6c894666354-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba6c894666354-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">trend_tweets</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-v">text</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bcf82efdba6c894666354-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p">#print(tweet_html)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba6c894666354-22">&nbsp;</div><div class="crayon-line" id="crayon-5bcf82efdba6c894666354-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">trend_data</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-e">tuple</span><span class="crayon-sy">(</span><span class="crayon-v">trend_tweets</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba6c894666354-24">&nbsp;</div><div class="crayon-line" id="crayon-5bcf82efdba6c894666354-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">trend_data</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0022 seconds] -->
<p></p>
<p><strong>A Statistics class</strong></p>
<p>As discussed, we need a lightweight statistics class. The code for it is actually quite simple. It is taken <a href="https://github.com/shantnu/TwitterAnalyser/blob/master/Part3/twit2.py">from here</a>:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82efdba70896729033" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
class stats():

    def __init__(self):
        self.lang = []
        self.top_lang = []
        self.top_tweets = []

    def add_lang(self, lang):
        self.lang.append(lang)

    def add_top_lang(self, top_lang):
        self.top_lang.append(top_lang)

    def add_top_tweets(self, tweet_html):
        self.top_tweets.append(tweet_html) 

    def get_stats(self):
        return self.lang, self.top_lang, self.top_tweets</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82efdba70896729033-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba70896729033-2">2</div><div class="crayon-num" data-line="crayon-5bcf82efdba70896729033-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba70896729033-4">4</div><div class="crayon-num" data-line="crayon-5bcf82efdba70896729033-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba70896729033-6">6</div><div class="crayon-num" data-line="crayon-5bcf82efdba70896729033-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba70896729033-8">8</div><div class="crayon-num" data-line="crayon-5bcf82efdba70896729033-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba70896729033-10">10</div><div class="crayon-num" data-line="crayon-5bcf82efdba70896729033-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba70896729033-12">12</div><div class="crayon-num" data-line="crayon-5bcf82efdba70896729033-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba70896729033-14">14</div><div class="crayon-num" data-line="crayon-5bcf82efdba70896729033-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba70896729033-16">16</div><div class="crayon-num" data-line="crayon-5bcf82efdba70896729033-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba70896729033-18">18</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82efdba70896729033-1"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">stats</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba70896729033-2">&nbsp;</div><div class="crayon-line" id="crayon-5bcf82efdba70896729033-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba70896729033-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">lang</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5bcf82efdba70896729033-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">top_lang</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba70896729033-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">top_tweets</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5bcf82efdba70896729033-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba70896729033-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">add_lang</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lang</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5bcf82efdba70896729033-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">lang</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">lang</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba70896729033-10">&nbsp;</div><div class="crayon-line" id="crayon-5bcf82efdba70896729033-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">add_top_lang</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">top_lang</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba70896729033-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">top_lang</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">top_lang</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bcf82efdba70896729033-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba70896729033-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">add_top_tweets</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tweet_html</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5bcf82efdba70896729033-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">top_tweets</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">tweet_html</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba70896729033-16">&nbsp;</div><div class="crayon-line" id="crayon-5bcf82efdba70896729033-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">get_stats</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba70896729033-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">lang</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">top_lang</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">top_tweets</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0014 seconds] -->
<p></p>
<p>As we can see, all we are doing is storing the data in Python dictionaries. So why use this method?</p>
<p>Since this is now an object, we can use it from multiple places. We will create it once, and pass the object around. That means, unlike global variables, if we need to change the code, it only needs to be done once.</p>
<p>Let&#8217;s see how the class is used. It will be created in the <em>TwitterMain</em> class&#8217;s <em>init()</em> function. Only showing new code:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82efdba73123836390" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
class TwitterMain():
    def __init__(self, num_tweets_to_grab, retweet_count):

        self.stats = stats()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82efdba73123836390-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba73123836390-2">2</div><div class="crayon-num" data-line="crayon-5bcf82efdba73123836390-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba73123836390-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82efdba73123836390-1"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">TwitterMain</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba73123836390-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">num_tweets_to_grab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">retweet_count</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5bcf82efdba73123836390-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba73123836390-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">stats</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">stats</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p>We are going to pass this object to the <em><span class="pl-en">twitter_listener</span></em> class, which actually grabs the streaming data:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82efdba76943151880" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
class twitter_listener(StreamListener):

    def __init__(self, num_tweets_to_grab, stats, get_tweet_html, retweet_count=10000):

        self.stats = stats</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82efdba76943151880-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba76943151880-2">2</div><div class="crayon-num" data-line="crayon-5bcf82efdba76943151880-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba76943151880-4">4</div><div class="crayon-num" data-line="crayon-5bcf82efdba76943151880-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82efdba76943151880-1"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">twitter_listener</span><span class="crayon-sy">(</span><span class="crayon-v">StreamListener</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba76943151880-2">&nbsp;</div><div class="crayon-line" id="crayon-5bcf82efdba76943151880-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">num_tweets_to_grab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stats</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">get_tweet_html</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">retweet_count</span><span class="crayon-o">=</span><span class="crayon-cn">10000</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba76943151880-4">&nbsp;</div><div class="crayon-line" id="crayon-5bcf82efdba76943151880-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">stats</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">stats</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p></p>
<p>If you remember, originally, we were printing the language data. We will now pass the data to our <em>stats</em> object:</p>
<p>Instead of:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82efdba79563928911" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
print(langs[json_data["lang"]])</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82efdba79563928911-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82efdba79563928911-1"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">langs</span><span class="crayon-sy">[</span><span class="crayon-v">json_data</span><span class="crayon-sy">[</span><span class="crayon-s">"lang"</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p>we&#8217;ll do:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82efdba7c811024619" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
self.stats.add_lang(langs[json_data["lang"]])</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82efdba7c811024619-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82efdba7c811024619-1"><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">stats</span><span class="crayon-sy">.</span><span class="crayon-e">add_lang</span><span class="crayon-sy">(</span><span class="crayon-v">langs</span><span class="crayon-sy">[</span><span class="crayon-v">json_data</span><span class="crayon-sy">[</span><span class="crayon-s">"lang"</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p>This will store the language in the <em>lang</em> list in our <em>stats</em> class. We will do the same for the other values we want to store.</p>
<p>Then, back in the main code, once we have gathered our streaming data, we can read back what we have stored by</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82efdba7f130808542" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
        lang, top_lang, top_tweets = self.stats.get_stats()
        print(Counter(lang))
        print(Counter(top_lang))
        print(top_tweets)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82efdba7f130808542-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba7f130808542-2">2</div><div class="crayon-num" data-line="crayon-5bcf82efdba7f130808542-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82efdba7f130808542-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82efdba7f130808542-1"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">lang</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">top_lang</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">top_tweets</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">stats</span><span class="crayon-sy">.</span><span class="crayon-e">get_stats</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba7f130808542-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">Counter</span><span class="crayon-sy">(</span><span class="crayon-v">lang</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bcf82efdba7f130808542-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">Counter</span><span class="crayon-sy">(</span><span class="crayon-v">top_lang</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82efdba7f130808542-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">top_tweets</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p></p>
<p>The <em>get_stats()</em> function returns everything we have stored, which we now print.</p>
<p>So what was the advantage of doing it this way?</p>
<ul>
<li>We have passed data from the *twitter_listener* to the *TwitterMain()* class without using global variables</li>
<li>The method is quite quick, as we are just storing the objects in memory</li>
<li>We can now read and write the stats in multiple places, which means one function could be updating them, while another could be reading them.</li>
</ul>
<p>Make sure you look at the <a href="https://github.com/shantnu/TwitterAnalyser/blob/master/Part3/twit2.py">whole code</a> to understand what is going on.</p>
<p>Next: Enough printing on the screen, we need to start saving the code in a database.</p>



	</div><!-- .entry-content -->

	
</article><!-- #post-## -->

	</main><!-- .site-main -->

	
</div><!-- .content-area -->


	<aside id="secondary" class="sidebar widget-area" role="complementary">
		<section id="search-4" class="widget widget_search">
<form role="search" method="get" class="search-form" action="/">
	<label>
		<span class="screen-reader-text">Search for:</span>
		<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
	</label>
	<button type="submit" class="search-submit"><span class="screen-reader-text">Search</span></button>
</form>
</section>	</aside><!-- .sidebar .widget-area -->

		</div><!-- .site-content -->

		<footer id="colophon" class="site-footer" role="contentinfo">
							<nav class="main-navigation" role="navigation" aria-label="Footer Primary Menu">
					<div class="menu-main-container"><ul id="menu-main-1" class="primary-menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-52"><a href="/articles/">Articles</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1533"><a href="/about/">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35"><a href="/contact/">Contact</a></li>
</ul></div>				</nav><!-- .main-navigation -->
			
			
			<div class="site-info">
								<span class="site-title"><a href="/" rel="home">Python For Engineers</a></span>
								<a href="https://wordpress.org/" class="imprint">
					Proudly powered by WordPress				</a>
			</div><!-- .site-info -->
		</footer><!-- .site-footer -->
	</div><!-- .site-inner -->
</div><!-- .site -->

<script type='text/javascript' src='/wp-content/themes/twentysixteen/js/skip-link-focus-fix.js?ver=20160816'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var screenReaderText = {"expand":"expand child menu","collapse":"collapse child menu"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/themes/twentysixteen/js/functions.js?ver=20160816'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var tve_dash_front = {"ajaxurl":"http:\/\/pythonforengineers.com\/wp-admin\/admin-ajax.php","force_ajax_send":"","is_crawler":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/thrive-visual-editor/thrive-dashboard/js/dist/frontend.min.js?ver=2.0.45'></script>
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.9.8'></script>
</body>
</html>
