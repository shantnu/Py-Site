<!DOCTYPE html>
<html lang="en-US" class="no-js">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="http://gmpg.org/xfn/11">
		<script>(function(html){html.className = html.className.replace(/\bno-js\b/,'js')})(document.documentElement);</script>
<title>Open a 5 GB file in Python using Sqlite &#8211; Python For Engineers</title>
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Python For Engineers &raquo; Feed" href="/feed/" />
<link rel="alternate" type="application/rss+xml" title="Python For Engineers &raquo; Comments Feed" href="/comments/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/pythonforengineers.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='crayon-css'  href='/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-github-css'  href='/wp-content/plugins/crayon-syntax-highlighter/themes/github/github.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='twentysixteen-fonts-css'  href='https://fonts.googleapis.com/css?family=Merriweather%3A400%2C700%2C900%2C400italic%2C700italic%2C900italic%7CMontserrat%3A400%2C700%7CInconsolata%3A400&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='genericons-css'  href='/wp-content/themes/twentysixteen/genericons/genericons.css?ver=3.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='twentysixteen-style-css'  href='/wp-content/themes/twentysixteen/style.css?ver=4.9.8' type='text/css' media='all' />
<!--[if lt IE 10]>
<link rel='stylesheet' id='twentysixteen-ie-css'  href='http://pythonforengineers.com/wp-content/themes/twentysixteen/css/ie.css?ver=20160816' type='text/css' media='all' />
<![endif]-->
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentysixteen-ie8-css'  href='http://pythonforengineers.com/wp-content/themes/twentysixteen/css/ie8.css?ver=20160816' type='text/css' media='all' />
<![endif]-->
<!--[if lt IE 8]>
<link rel='stylesheet' id='twentysixteen-ie7-css'  href='http://pythonforengineers.com/wp-content/themes/twentysixteen/css/ie7.css?ver=20160816' type='text/css' media='all' />
<![endif]-->
<script type='text/javascript' src='/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/pythonforengineers.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='http://pythonforengineers.com/wp-content/themes/twentysixteen/js/html5.js?ver=3.7.3'></script>
<![endif]-->
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 4.9.8" />
<link rel="canonical" href="/open-a-5-gb-file-in-python/" />
<link rel='shortlink' href='/?p=1871' />
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Fopen-a-5-gb-file-in-python%2F" />
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Fopen-a-5-gb-file-in-python%2F&#038;format=xml" />
</head>

<body class="page-template-default page page-id-1871">
<div id="page" class="site">
	<div class="site-inner">
		<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

		<header id="masthead" class="site-header" role="banner">
			<div class="site-header-main">
				<div class="site-branding">
					
											<p class="site-title"><a href="/" rel="home">Python For Engineers</a></p>
									</div><!-- .site-branding -->

									<button id="menu-toggle" class="menu-toggle">Menu</button>

					<div id="site-header-menu" class="site-header-menu">
													<nav id="site-navigation" class="main-navigation" role="navigation" aria-label="Primary Menu">
								<div class="menu-main-container"><ul id="menu-main" class="primary-menu"><li id="menu-item-52" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-52"><a href="/articles/">Articles</a></li>
<li id="menu-item-1533" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1533"><a href="/about/">About</a></li>
<li id="menu-item-35" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35"><a href="/contact/">Contact</a></li>
</ul></div>							</nav><!-- .main-navigation -->
						
											</div><!-- .site-header-menu -->
							</div><!-- .site-header-main -->

					</header><!-- .site-header -->

		<div id="content" class="site-content">

<div id="primary" class="content-area">
	<main id="main" class="site-main" role="main">
		
<article id="post-1871" class="post-1871 page type-page status-publish hentry">
	<header class="entry-header">
		<h1 class="entry-title">Open a 5 GB file in Python using Sqlite</h1>	</header><!-- .entry-header -->

	
	<div class="entry-content">
		<p><strong>The Problem</strong>: We have a 5GB file, and no tool we have can work with such large files (provided you even have enough free RAM to hold the whole thing in memory).</p>
<p>How do we get around this?</p>
<p>The solution is to use a database. While some people think this answer is common sense, I have seen far too many people intimidated with databases, so this series also serves as an introduction to SQL and Sqlite.</p>
<p>The code is available <a href="https://github.com/shantnu/Open-Gigabyte-File-Python">here</a>. We will be using Ipython Notebooks( see <a href="/introduction-to-ipython-jupyter-notebooks/">here </a>for a quick intro). To start off, we will get a gentle intro to SQL. If you have used SQL with SqLite before, still have a look at the notebook, as I will be referring back to it.<em> <span class="css-truncate css-truncate-target">Intro to SqLite.ipynb</span></em> is the notebook we are working with.</p>
<p><em>There are 6 videos + transcript in this series. The videos are mixed with the transcripts, so scroll down if you are only interested in the videos. Make sure you turn on HD.<br />
</em></p>
<p><em>Minor correction to video below: Sqlite can handle concurrent connections, though it may not be as fast.</em></p>
<p><iframe width="800" height="450" src="https://player.vimeo.com/video/147240385?title=0&amp;byline=0&amp;portrait=0" frameborder="0" webkitallowfullscreen="webkitallowfullscreen" mozallowfullscreen="mozallowfullscreen" allowfullscreen="allowfullscreen"></iframe></p>
<p><strong>Transcript</strong>:</p>
<p>So the file we want to open is almost 5.3GB. No tool (I know of) can open it. Ms Excel can&#8217;t open it, Openoffice can&#8217;t open it, Notepad++ can&#8217;t open it. Not  to mention, you may not even have enough memory to open it.</p>
<p>Even if you buy a more powerful machine, the lack of tools to work with large files will hold you back.</p>
<p>So how do you open a 5GB file? <em>Not all of it at the same time</em> is the answer. You store the data in a database and read it.</p>
<h2>Why use a database?</h2>
<p>Many scientists and engineers happy to use Ms Excel, CSV files, or even text files. Nothing wrong with that. It works.</p>
<p>Until it doesn&#8217;t.</p>
<p>For an example, just look at the current file. It didn&#8217;t start off as a 5GB file, but grew over time till it became too large to open with Excel.</p>
<p>Databases routinely handle Gigabytes of data without any problems, so we should be using them.</p>
<p>Advantages of using a database: <a href="http://programmers.stackexchange.com/questions/190482/why-use-a-database-instead-of-just-saving-your-data-to-disk">http://programmers.stackexchange.com/questions/190482/why-use-a-database-instead-of-just-saving-your-data-to-disk</a></p>
<p>Have a skim through the top rated answer. You don&#8217;t need to master everything database related, but make sure when someone uses the word <em>Acid</em> you don&#8217;t say <em>Yeah man, groovy. Have some so we can <a href="http://www.thefreedictionary.com/LSD">try it now</a>?</em></p>
<p>I have seen a fear of SQL in many people (and this is not a judgement, as I was in this club for a long time).</p>
<p><strong>Real Reason (TM) programmers don&#8217;t use a database</strong>: They are scared of the weird syntax of SQL, which looks a lot like it was a language invented for business types in the 60s-70s (it was!). But it&#8217;s not that scary.</p>
<p>Okay, to the lesson.  Get the data from here:</p>
<p>Download the file:<a href="http://download.cms.gov/nppes/NPI_Files.html"> http://download.cms.gov/nppes/NPI_Files.html</a></p>
<p>If you are on Windows,  use <a href="http://www.7-zip.org/">7zip </a>to unzip it, as Windows gets confused with the file.</p>
<p>We will be using something called Sqlite, a free database that comes inbuilt with Python. While it&#8217;s a simple database, the main thing I want to emphasis is, it&#8217;s <strong>not a toy database</strong>. Sqlite can easily handle websites with <a href="https://www.sqlite.org/whentouse.html">100K/day visitors</a>. And since it is file based, it is easy to share the data.</p>
<h2>Introduction to Sqlite with Python</h2>
<p>Okay, let&#8217;s get started.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec071995377152" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import sqlite3</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec071995377152-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec071995377152-1"><span class="crayon-e">import </span><span class="crayon-v">sqlite3</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p></p>
<p>Since sqlite is inbuilt, we just import it.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec081103750306" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
conn = sqlite3.connect(":memory:")
c = conn.cursor()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec081103750306-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec081103750306-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec081103750306-1"><span class="crayon-v">conn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sqlite3</span><span class="crayon-sy">.</span><span class="crayon-e">connect</span><span class="crayon-sy">(</span><span class="crayon-s">":memory:"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec081103750306-2"><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">conn</span><span class="crayon-sy">.</span><span class="crayon-e">cursor</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p></p>
<p>Sqlite is fairly simple, in that if you don&#8217;t have a database, it creates one for you when you run the <em>connect()</em> function.</p>
<p>If you give it a file name, it will create a database with that name (which we will see in the next example).</p>
<p>For the current example, we are using <em>:memory:</em>, which means the database is stored in memory, and will be lost when the Python session is closed.</p>
<p>In the second line, we open a <em>cursor()</em> connection to the database, which is sort of a command line interface to the database (though controlled by Python).</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec087053986655" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
c.execute("CREATE TABLE my_table (Name TEXT NOT NULL, Salary INTEGER NOT NULL DEFAULT 0)")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec087053986655-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec087053986655-1"><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-e">execute</span><span class="crayon-sy">(</span><span class="crayon-s">"CREATE TABLE my_table (Name TEXT NOT NULL, Salary INTEGER NOT NULL DEFAULT 0)"</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p>A few things about SQL. SQL itself is case insensitive, but good practice is to use UPPER CASE for SQL commands, and lower case (or Sentence Case) for stuff we create, like tables.</p>
<p>Data in a database is stored in tables. In the example above, we create a table called <em>my_table</em>, which has two fields. The first is <em>Name</em>. The keywords in uppercase in front of it was SQL commands. They tell us the field <em>Name</em> is a type of <em>Text</em>, and cannot be null (empty).</p>
<p>The next field is <em>Salary</em>. This is a type <em>Integer</em>, again, cannot be null, and will have a default value of 0. The default value is not really needed, as we have already defined the field cannot be empty. In case we did not have a <em>NOT NULL</em> instruction, Sql would give a default value of 0 to any empty <em>Salary</em> fields.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec08d656539502" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
conn.commit()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec08d656539502-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec08d656539502-1"><span class="crayon-v">conn</span><span class="crayon-sy">.</span><span class="crayon-e">commit</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p><em>commit()</em> actually writes the data to the database. If you forget to commit, you will lose all your changes. You can commit after each instruction, or once at the end.</p>
<p>Why would you want to do it once? In case you have multiple users, committing once will save time, as the database will be locked down when writing to it (to prevent data corruption, see Acid). I prefer to commit after each instruction, because I&#8217;m not really worried about 200 other people writing to the database at the same time.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec092243351478" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
c.execute("INSERT INTO my_table VALUES ('Joe', 3000)")
conn.commit()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec092243351478-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec092243351478-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec092243351478-1"><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-e">execute</span><span class="crayon-sy">(</span><span class="crayon-s">"INSERT INTO my_table VALUES ('Joe', 3000)"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec092243351478-2"><span class="crayon-v">conn</span><span class="crayon-sy">.</span><span class="crayon-e">commit</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p></p>
<p>Okay, so our database has been created, but it is empty. Time to fill it with values. <em>INSERT INTO</em> is the SQL command, and what follows is the way to insert data into the table we created.</p>
<p><em><em>Warning</em>: SQL commands may vary across different databases (although not for simple commands like insert). If you were using a different database like MySql, you might need slightly different commands. I recommend just Googling &#8220;How to do X in database Y&#8221;.</em></p>
<p>We insert two values: The name <em>Joe</em> and salary of <em>3000</em>.</p>
<p>Of course, this is a very slow process. What if you have 10,000 names and salaries? Will you be sitting there running one insert command after another?</p>
<p>Sqlite provides a way to insert multiple values.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec098764423789" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
names = [('James', 2000), ('Sally', 5000)]

c.executemany("INSERT INTO my_table VALUES (?,?)", names)
conn.commit()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec098764423789-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec098764423789-2">2</div><div class="crayon-num" data-line="crayon-5bcf82e8ec098764423789-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec098764423789-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec098764423789-1"><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'James'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2000</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">'Sally'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec098764423789-2">&nbsp;</div><div class="crayon-line" id="crayon-5bcf82e8ec098764423789-3"><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-e">executemany</span><span class="crayon-sy">(</span><span class="crayon-s">"INSERT INTO my_table VALUES (?,?)"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec098764423789-4"><span class="crayon-v">conn</span><span class="crayon-sy">.</span><span class="crayon-e">commit</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p></p>
<p>You need to create a list of dictionaries, as we have done for <em>names</em> above.</p>
<p>Then we use the <em>(?, ?) </em>method to insert multiple values. Sqlite will automatically insert all the values for us.</p>
<p>So we have inserted a few values into our database. Now is the time to read them.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec09d787176428" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
c.execute("SELECT * FROM my_table WHERE name = 'Joe'")
result = c.fetchall()
print(result)

[('Joe', 3000)]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec09d787176428-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec09d787176428-2">2</div><div class="crayon-num" data-line="crayon-5bcf82e8ec09d787176428-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec09d787176428-4">4</div><div class="crayon-num" data-line="crayon-5bcf82e8ec09d787176428-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec09d787176428-1"><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-e">execute</span><span class="crayon-sy">(</span><span class="crayon-s">"SELECT * FROM my_table WHERE name = 'Joe'"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec09d787176428-2"><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-e">fetchall</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bcf82e8ec09d787176428-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec09d787176428-4">&nbsp;</div><div class="crayon-line" id="crayon-5bcf82e8ec09d787176428-5"><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'Joe'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3000</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p></p>
<p>The <em>Select</em> command is used to search for data. You can search individual columns in tables, though we are using * to search through everything.</p>
<p>Once we run the SQL search command, we need to call <em>fetchall()</em> to get the results. As you can see, we get our name.</p>
<p>What if we search for something that doesn&#8217;t exist?</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec0a2818635167" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
c.execute("SELECT * FROM my_table WHERE name = 'MrT'")
result = c.fetchall()
print(result)

[]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec0a2818635167-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0a2818635167-2">2</div><div class="crayon-num" data-line="crayon-5bcf82e8ec0a2818635167-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0a2818635167-4">4</div><div class="crayon-num" data-line="crayon-5bcf82e8ec0a2818635167-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec0a2818635167-1"><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-e">execute</span><span class="crayon-sy">(</span><span class="crayon-s">"SELECT * FROM my_table WHERE name = 'MrT'"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0a2818635167-2"><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-e">fetchall</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bcf82e8ec0a2818635167-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0a2818635167-4">&nbsp;</div><div class="crayon-line" id="crayon-5bcf82e8ec0a2818635167-5"><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p></p>
<p>We get an empty array back.</p>
<p>We can also search with conditions.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec0a7247643835" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
c.execute("SELECT * FROM my_table WHERE salary &gt; 2000")
result = c.fetchall()
print(result)

[('Joe', 3000), ('Sally', 5000)]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec0a7247643835-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0a7247643835-2">2</div><div class="crayon-num" data-line="crayon-5bcf82e8ec0a7247643835-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0a7247643835-4">4</div><div class="crayon-num" data-line="crayon-5bcf82e8ec0a7247643835-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec0a7247643835-1"><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-e">execute</span><span class="crayon-sy">(</span><span class="crayon-s">"SELECT * FROM my_table WHERE salary &gt; 2000"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0a7247643835-2"><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-e">fetchall</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bcf82e8ec0a7247643835-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0a7247643835-4">&nbsp;</div><div class="crayon-line" id="crayon-5bcf82e8ec0a7247643835-5"><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'Joe'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3000</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">'Sally'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p></p>
<p>The above returns all people with salaries &gt; 2000.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec0ac236232365" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
conn.commit()
conn.close()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec0ac236232365-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0ac236232365-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec0ac236232365-1"><span class="crayon-v">conn</span><span class="crayon-sy">.</span><span class="crayon-e">commit</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0ac236232365-2"><span class="crayon-v">conn</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p>A final <em>commit()</em>, and then we <em>close()</em> the database.</p>
<p>This was a very simple introduction to Sql and Sqlite. We will be building on this knowledge and looking at more complicated examples when we open our 5GB file.</p>
<p>I deliberately kept this section simple, so you can see how simple SQL is. Most of the commands are intuitive and easy to follow. If you get stuck, you can get an answer in 2-3 Google searches. In the examples below, we will cover this in more detail.</p>
<p>Okay, with that knowledge, let&#8217;s start with reading our 5 GB file.</p>
<h2>Reading our file and storing in a database</h2>
<p>I broke the video into 2 parts for easy editing, but it&#8217;s actually one long video. The notebook we are using is <em>Open 5 Gb file.ipynb.</em> Transcript is below the 2 videos.<em><br />
</em></p>
<p><iframe width="800" height="450" src="https://player.vimeo.com/video/147308306?title=0&amp;byline=0&amp;portrait=0" frameborder="0" webkitallowfullscreen="webkitallowfullscreen" mozallowfullscreen="mozallowfullscreen" allowfullscreen="allowfullscreen"></iframe></p>
<p><iframe width="800" height="450" src="https://player.vimeo.com/video/147312593?title=0&amp;byline=0&amp;portrait=0" frameborder="0" webkitallowfullscreen="webkitallowfullscreen" mozallowfullscreen="mozallowfullscreen" allowfullscreen="allowfullscreen"></iframe></p>
<p>Make sure you have downloaded the file from <a href="http://download.cms.gov/nppes/NPI_Files.html">http://download.cms.gov/nppes/NPI_Files.html</a></p>
<p>On Windows, use 7Zip to unzip it.</p>
<p>Also download Sqlite Browser, a cool tool that allows us to look at the database visually. <a href="http://sqlitebrowser.org/">http://sqlitebrowser.org/</a></p>
<p>Have a look at the data you downloaded. The 2 pdf files describe all the data. There is a csv file with <em>FileHeader</em> in the name. That&#8217;s just the header. Open it in a text editor.</p>
<p><a href="/wp-content/uploads/2015/12/gigfile2.png" rel="attachment wp-att-2050"><img src="/wp-content/uploads/2015/12/gigfile2.png" alt="gigfile2" class="aligncenter wp-image-2050" height="404" width="759" srcset="/wp-content/uploads/2015/12/gigfile2.png 1366w, /wp-content/uploads/2015/12/gigfile2-300x160.png 300w, /wp-content/uploads/2015/12/gigfile2-768x409.png 768w, /wp-content/uploads/2015/12/gigfile2-1024x545.png 1024w" sizes="(max-width: 759px) 85vw, 759px" /></a></p>
<p>All of that is <strong>one line</strong>. It is being word wrapped, but it&#8217;s one kilometer long line of text. You can see how entries this database has, which is why it is so big.</p>
<p>To make our lives easier (because I really don&#8217;t want to type 557 SQL commands to create this database), we will only extract 4 values from this database: Name (of doctor), Legal name (business name), city and state.</p>
<p>Not all of these values may exist: This is one of the risk of working with data that has been compiled from multiple sources. We will have to assume some fields maybe empty, which is why we can&#8217;t use <em>NOT NULL</em> we used in the last example.</p>
<p>The <em>Name</em> field is itself compromised of 3 different fields. If look at the header field, you will see:</p>
<p><em>&#8220;Provider Last Name (Legal Name)&#8221;,&#8221;Provider First Name&#8221;,&#8221;Provider Middle Name&#8221;</em></p>
<p>We will combine these three to store the name as one field. Again, a decision I just made up, no rule you have to do it this way.</p>
<p>Let&#8217;s look at the code. We will create the database first.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec0b3430115562" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import sqlite3
db = "npi_data.db"

conn = sqlite3.connect(db)
c = conn.cursor()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec0b3430115562-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0b3430115562-2">2</div><div class="crayon-num" data-line="crayon-5bcf82e8ec0b3430115562-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0b3430115562-4">4</div><div class="crayon-num" data-line="crayon-5bcf82e8ec0b3430115562-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec0b3430115562-1"><span class="crayon-e">import </span><span class="crayon-e">sqlite3</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0b3430115562-2"><span class="crayon-v">db</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"npi_data.db"</span></div><div class="crayon-line" id="crayon-5bcf82e8ec0b3430115562-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0b3430115562-4"><span class="crayon-v">conn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sqlite3</span><span class="crayon-sy">.</span><span class="crayon-e">connect</span><span class="crayon-sy">(</span><span class="crayon-v">db</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bcf82e8ec0b3430115562-5"><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">conn</span><span class="crayon-sy">.</span><span class="crayon-e">cursor</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p></p>
<p>Same as in the last example, except this time we give it a file name to connect to (<em>npi_data.db</em>). Sqlite will create this file if it doesn&#8217;t exist (though I recommend you delete the file manually if you run the code again).</p>
<p>We then connect to the database and open a cursor connection.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec0b9108710721" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
c.execute("CREATE TABLE npi_data (name TEXT, legal_name TEXT, city TEXT, state TEXT)")
conn.commit()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec0b9108710721-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0b9108710721-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec0b9108710721-1"><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-e">execute</span><span class="crayon-sy">(</span><span class="crayon-s">"CREATE TABLE npi_data (name TEXT, legal_name TEXT, city TEXT, state TEXT)"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0b9108710721-2"><span class="crayon-v">conn</span><span class="crayon-sy">.</span><span class="crayon-e">commit</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p></p>
<p>And we create our table with 4 values:<em> name, legal_name, city and state. </em>All are text, to keep things simple.</p>
<p>At this stage, open up Sqlite browser, and open the database file we just created.</p>
<p><a href="/wp-content/uploads/2015/12/gigfile3.png" rel="attachment wp-att-2051"><img src="/wp-content/uploads/2015/12/gigfile3.png" alt="gigfile3" class="aligncenter size-full wp-image-2051" height="366" width="1366" srcset="/wp-content/uploads/2015/12/gigfile3.png 1366w, /wp-content/uploads/2015/12/gigfile3-300x80.png 300w, /wp-content/uploads/2015/12/gigfile3-768x206.png 768w, /wp-content/uploads/2015/12/gigfile3-1024x274.png 1024w" sizes="(max-width: 709px) 85vw, (max-width: 909px) 67vw, (max-width: 1362px) 62vw, 840px" /></a>This is just a good confirmation that our database was created as expected. We can see the table we created.</p>
<p>You can go to the <em>Browse data</em> tab, but it will be empty for now.</p>
<p>Okay, now we come to the meat of the code that will read our values.</p>
<p><strong>Note</strong>: <em>In the video, I develop this code from scratch, so I explain the choices I made, and why I did certain things in certain ways. I also make some mistakes on the way. In the transcript, I will just explain the final working code. For better explanation, I recommend watching the video.</em></p>
<p>We will see the whole function function, and then go over it line by line.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec0bf768032020" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
counter = 0
db_list = []
with open("npidata_20050523-20151108.csv") as infile:
    for line in infile:
        line = line.replace('"', '')
        data = line.split(",")
        if (counter &gt; 0):
            city  = data[22]
            state = data[23]
            name  = data[6] + " " + data[7] + " " + data[5]
            legal_name = data[4]
            
            db_list.append( (name, legal_name, city, state) )
            
            #print("Name: " + data[6] + " " + data[7] + " " + data[5])
            #print("Legal Name: " + data[4])
            # print(data[22], data[23])
            #print("\n\n")
            #print(line)
        #if counter == 5:
        #    break
        counter += 1
print(len(db_list)        )</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec0bf768032020-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0bf768032020-2">2</div><div class="crayon-num" data-line="crayon-5bcf82e8ec0bf768032020-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0bf768032020-4">4</div><div class="crayon-num" data-line="crayon-5bcf82e8ec0bf768032020-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0bf768032020-6">6</div><div class="crayon-num" data-line="crayon-5bcf82e8ec0bf768032020-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0bf768032020-8">8</div><div class="crayon-num" data-line="crayon-5bcf82e8ec0bf768032020-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0bf768032020-10">10</div><div class="crayon-num" data-line="crayon-5bcf82e8ec0bf768032020-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0bf768032020-12">12</div><div class="crayon-num" data-line="crayon-5bcf82e8ec0bf768032020-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0bf768032020-14">14</div><div class="crayon-num" data-line="crayon-5bcf82e8ec0bf768032020-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0bf768032020-16">16</div><div class="crayon-num" data-line="crayon-5bcf82e8ec0bf768032020-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0bf768032020-18">18</div><div class="crayon-num" data-line="crayon-5bcf82e8ec0bf768032020-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0bf768032020-20">20</div><div class="crayon-num" data-line="crayon-5bcf82e8ec0bf768032020-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0bf768032020-22">22</div><div class="crayon-num" data-line="crayon-5bcf82e8ec0bf768032020-23">23</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec0bf768032020-1"><span class="crayon-v">counter</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0bf768032020-2"><span class="crayon-v">db_list</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5bcf82e8ec0bf768032020-3"><span class="crayon-e">with </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-s">"npidata_20050523-20151108.csv"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">infile</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0bf768032020-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">line </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">infile</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5bcf82e8ec0bf768032020-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">line</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">line</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-s">'"'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0bf768032020-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">line</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">","</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bcf82e8ec0bf768032020-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">counter</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0bf768032020-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">city</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-cn">22</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5bcf82e8ec0bf768032020-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-cn">23</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0bf768032020-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">name</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-cn">6</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">" "</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-cn">7</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">" "</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-cn">5</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5bcf82e8ec0bf768032020-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">legal_name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0bf768032020-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5bcf82e8ec0bf768032020-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">db_list</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">legal_name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">city</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">state</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0bf768032020-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5bcf82e8ec0bf768032020-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p">#print("Name: " + data[6] + " " + data[7] + " " + data[5])</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0bf768032020-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p">#print("Legal Name: " + data[4])</span></div><div class="crayon-line" id="crayon-5bcf82e8ec0bf768032020-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p"># print(data[22], data[23])</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0bf768032020-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p">#print("\n\n")</span></div><div class="crayon-line" id="crayon-5bcf82e8ec0bf768032020-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p">#print(line)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0bf768032020-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p">#if counter == 5:</span></div><div class="crayon-line" id="crayon-5bcf82e8ec0bf768032020-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p">#&nbsp;&nbsp;&nbsp;&nbsp;break</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0bf768032020-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">counter</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5bcf82e8ec0bf768032020-23"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">db_list</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0040 seconds] -->
<p></p>
<p>Okay, let&#8217;s go over it in parts.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec0c5799490997" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
counter = 0
db_list = []</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec0c5799490997-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0c5799490997-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec0c5799490997-1"><span class="crayon-v">counter</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0c5799490997-2"><span class="crayon-v">db_list</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p><em>counter</em> will be explained when we use it. <em>db_list</em> is a list of dictionaries that will contain the values we want to write to the database (using the<em> (?, ?)</em> method we saw in the first video.)</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec0ca810959658" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
with open("npidata_20050523-20151108.csv") as infile:
    for line in infile:</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec0ca810959658-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0ca810959658-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec0ca810959658-1"><span class="crayon-e">with </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-s">"npidata_20050523-20151108.csv"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">infile</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0ca810959658-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">line </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">infile</span><span class="crayon-o">:</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p></p>
<p>We open our file with the <em>with</em> command (a great feature, as it automatically closes the file and handles any errors).</p>
<p>The next line is important. How do you open a 5GB file? <em>Line by line</em>. We loop over each line in the file.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec0cf130412920" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
line = line.replace('"', '')</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec0cf130412920-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec0cf130412920-1"><span class="crayon-v">line</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">line</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-s">'"'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p></p>
<p>The problem with the names in the file is, they are stored with inverted commas. So: <em>Joe</em> is stored as <em>&#8220;Joe&#8221;</em>.</p>
<p>Problem is, Python automatically adds inverted commas to strings, so the name becomes <em>&#8220;&#8221;Joe&#8221;&#8221;</em></p>
<p>In the video, this got me and I had to work around it.</p>
<p>The way is, we remove all inverted commas (&#8220;&#8221;). That&#8217;s what the code above is doing. We don&#8217;t need inverted commas, as Python will do that for us.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec0d5219805284" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
data = line.split(",")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec0d5219805284-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec0d5219805284-1"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">line</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">","</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p>You may note the files are comma separated (csvs). We will not be using Pandas for this example, but manually extract the fields.</p>
<p>We call the <em>split(&#8220;,&#8221;)</em> to create a list of entries separated by commas. So:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec0da736228664" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
"Hello, World, I am going".split(",")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec0da736228664-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec0da736228664-1"><span class="crayon-s">"Hello, World, I am going"</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">","</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p>will become:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec0df484163175" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
['Hello', ' World', ' I am going']</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec0df484163175-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec0df484163175-1"><span class="crayon-sy">[</span><span class="crayon-s">'Hello'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">' World'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">' I am going'</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p>We split each line of the file we get, so we can get all the individual fields.</p>
<p>So in the header field, the first entry is <em>&#8220;NPI&#8221;</em>. The field we need, the legal name (<em>&#8220;Provider Organization Name (Legal Business Name)&#8221;</em>) is the 5th entry ( [4] in Python, as Python counts from 0).</p>
<p>I have gone ahead, and counted the values we need to extract for you. This will become clearer in the code.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec0e4823722059" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
if (counter &gt; 0):
            city  = data[22]
            state = data[23]
            name  = data[6] + " " + data[7] + " " + data[5]
            legal_name = data[4]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec0e4823722059-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0e4823722059-2">2</div><div class="crayon-num" data-line="crayon-5bcf82e8ec0e4823722059-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0e4823722059-4">4</div><div class="crayon-num" data-line="crayon-5bcf82e8ec0e4823722059-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec0e4823722059-1"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">counter</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0e4823722059-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">city</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-cn">22</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5bcf82e8ec0e4823722059-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-cn">23</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0e4823722059-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">name</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-cn">6</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">" "</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-cn">7</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">" "</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-cn">5</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5bcf82e8ec0e4823722059-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">legal_name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0017 seconds] -->
<p></p>
<p>We are checking if <em>counter &gt; 0</em> because the first line contains the header.</p>
<p>As I said above, the legal_name is in data[4]. city and state in 22 and 23 respectively.</p>
<p>The name field might require an explanation. The name is spread across 3 different fields, and is of the format:</p>
<p><em>Sirname, First name, Middle Name</em></p>
<p>We are combining these 3 fields to get: <em>First name, middle name, sirname</em></p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec0ea379109132" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
db_list.append( (name, legal_name, city, state) )
counter += 1</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec0ea379109132-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0ea379109132-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec0ea379109132-1"><span class="crayon-v">db_list</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">legal_name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">city</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">state</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0ea379109132-2"><span class="crayon-v">counter</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p></p>
<p>Once we get the four fields, we add them to our list.</p>
<p>You could also write them to the database as you went along. It depends. If you were going to write everything to the database, it would make more sense to write as you go along, otherwise you&#8217;d be back to the old problem of storing 5GB data in memory. Since we are only working with  subset of the data, it will fit in memory.</p>
<p>We then increment our counter, which isn&#8217;t really used much, except for debugging.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec0ef314651193" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
print(len(db_list))

4740851</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec0ef314651193-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0ef314651193-2">2</div><div class="crayon-num" data-line="crayon-5bcf82e8ec0ef314651193-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec0ef314651193-1"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">db_list</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0ef314651193-2">&nbsp;</div><div class="crayon-line" id="crayon-5bcf82e8ec0ef314651193-3"><span class="crayon-cn">4740851</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p>At the end we print the length of our list. It&#8217;s almost 4.7 million. Note, that each element in our list contains 4 values, so the total number of values = 4.7 * 4 = 18.96 million entries.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec0f4812606537" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
c.executemany("INSERT INTO npi_data VALUES (?, ?, ?, ?)", db_list)

conn.commit()
conn.close()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec0f4812606537-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0f4812606537-2">2</div><div class="crayon-num" data-line="crayon-5bcf82e8ec0f4812606537-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0f4812606537-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec0f4812606537-1"><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-e">executemany</span><span class="crayon-sy">(</span><span class="crayon-s">"INSERT INTO npi_data VALUES (?, ?, ?, ?)"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">db_list</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0f4812606537-2">&nbsp;</div><div class="crayon-line" id="crayon-5bcf82e8ec0f4812606537-3"><span class="crayon-v">conn</span><span class="crayon-sy">.</span><span class="crayon-e">commit</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0f4812606537-4"><span class="crayon-v">conn</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p></p>
<p>Using the technique we learnt in the first video, we write the whole list to the database in one go, and close the database.</p>
<p>Open up the database in Sqlite Browser again, and go to the <em>Browse data</em> tab.</p>
<p><a href="/wp-content/uploads/2015/12/gigfile4.png" rel="attachment wp-att-2053"><img src="/wp-content/uploads/2015/12/gigfile4.png" alt="gigfile4" class="aligncenter wp-image-2053" height="545" width="747" srcset="/wp-content/uploads/2015/12/gigfile4.png 952w, /wp-content/uploads/2015/12/gigfile4-300x219.png 300w, /wp-content/uploads/2015/12/gigfile4-768x561.png 768w" sizes="(max-width: 747px) 85vw, 747px" /></a></p>
<p>Yup, the data is all there.</p>
<p>Right to the next video. How do we actually search in this database?</p>
<h2>Querying (searching) our database</h2>
<p><iframe width="800" height="450" src="https://player.vimeo.com/video/147315761?title=0&amp;byline=0&amp;portrait=0" frameborder="0" webkitallowfullscreen="webkitallowfullscreen" mozallowfullscreen="mozallowfullscreen" allowfullscreen="allowfullscreen"></iframe></p>
<p>We will start by opening the database.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec0fa213733000" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import sqlite3
db = "npi_data.db"
conn = sqlite3.connect(db)
c = conn.cursor()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec0fa213733000-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0fa213733000-2">2</div><div class="crayon-num" data-line="crayon-5bcf82e8ec0fa213733000-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0fa213733000-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec0fa213733000-1"><span class="crayon-e">import </span><span class="crayon-e">sqlite3</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0fa213733000-2"><span class="crayon-v">db</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"npi_data.db"</span></div><div class="crayon-line" id="crayon-5bcf82e8ec0fa213733000-3"><span class="crayon-v">conn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sqlite3</span><span class="crayon-sy">.</span><span class="crayon-e">connect</span><span class="crayon-sy">(</span><span class="crayon-v">db</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0fa213733000-4"><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">conn</span><span class="crayon-sy">.</span><span class="crayon-e">cursor</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p></p>
<p>For our first search, we want to know how many practices there are in the city of Houston.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec0ff114013865" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
c.execute("SELECT * FROM npi_data WHERE lower(city)='houston'")
result = c.fetchall()
print(len(result))

37661</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec0ff114013865-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0ff114013865-2">2</div><div class="crayon-num" data-line="crayon-5bcf82e8ec0ff114013865-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec0ff114013865-4">4</div><div class="crayon-num" data-line="crayon-5bcf82e8ec0ff114013865-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec0ff114013865-1"><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-e">execute</span><span class="crayon-sy">(</span><span class="crayon-s">"SELECT * FROM npi_data WHERE lower(city)='houston'"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0ff114013865-2"><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-e">fetchall</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bcf82e8ec0ff114013865-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec0ff114013865-4">&nbsp;</div><div class="crayon-line" id="crayon-5bcf82e8ec0ff114013865-5"><span class="crayon-cn">37661</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p></p>
<p>One thing you will note is that I&#8217;m only printing the length of the result, not the actual result. That&#8217;s because printing 37,661 results will take up the whole screen. Feel free to change the code and print the actual results if you want.</p>
<p>Ok, to the SQL. The SQL instrustion should be fairly simple. We are searching the whole database where the city is Houston. A few points.</p>
<p>One, I&#8217;m doing <em>lower(city)</em>, as the original data is in uppercase. Even though SQL commands are case insensitive, the actual data isn&#8217;t.</p>
<p>One more really trick thing. In the SQL command, I am mixing single and double inverted commas.</p>
<p>Everything under <em>c.execute()</em> is in double commas ( &#8221; &#8221; ). While the city houston is in single inverted commas <em>&#8216;houston&#8217;</em>.</p>
<p>We have to do it this way, otherwise Python will get confused. The double inverted commas are for the Python instruction, executed in <em>c.execute()</em>. The single commas are so that Sqlite correctly interprets <em>houston</em> as a string. Try changing <em>houston</em> to double commas in your code, and you&#8217;ll see what I&#8217;m talking about.</p>
<p>Next, I found a city called <em>Athens</em> in the list (like the Greek capital). We search for that:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec104540422681" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
c.execute("SELECT * FROM npi_data WHERE lower(city)='athens')
result = c.fetchall()
print(len(result))

2959</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec104540422681-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec104540422681-2">2</div><div class="crayon-num" data-line="crayon-5bcf82e8ec104540422681-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec104540422681-4">4</div><div class="crayon-num" data-line="crayon-5bcf82e8ec104540422681-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec104540422681-1"><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-e">execute</span><span class="crayon-sy">(</span>"<span class="crayon-e">SELECT *</span><span class="crayon-h"> </span><span class="crayon-e">FROM </span><span class="crayon-e">npi_data </span><span class="crayon-e">WHERE </span><span class="crayon-e">lower</span><span class="crayon-sy">(</span><span class="crayon-v">city</span><span class="crayon-sy">)</span><span class="crayon-o">=</span><span class="crayon-s">'athens'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec104540422681-2"><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-e">fetchall</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bcf82e8ec104540422681-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec104540422681-4">&nbsp;</div><div class="crayon-line" id="crayon-5bcf82e8ec104540422681-5"><span class="crayon-cn">2959</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p></p>
<p>There are almost 3000 results, but surprisingly, there are multiple Athens. How do we only search for the Athens in the state of Texas?</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec10a061277221" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
c.execute("SELECT * FROM npi_data WHERE lower(city)='athens' and state='TX'")
result = c.fetchall()
print(len(result))

205</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec10a061277221-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec10a061277221-2">2</div><div class="crayon-num" data-line="crayon-5bcf82e8ec10a061277221-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec10a061277221-4">4</div><div class="crayon-num" data-line="crayon-5bcf82e8ec10a061277221-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec10a061277221-1"><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-e">execute</span><span class="crayon-sy">(</span><span class="crayon-s">"SELECT * FROM npi_data WHERE lower(city)='athens' and state='TX'"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec10a061277221-2"><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-e">fetchall</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bcf82e8ec10a061277221-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec10a061277221-4">&nbsp;</div><div class="crayon-line" id="crayon-5bcf82e8ec10a061277221-5"><span class="crayon-cn">205</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p></p>
<p>SQL allows you to chain searches using an <em>and</em> command. In the example, we search for where city=houtson <strong>and</strong> state=TX (code for Texas).</p>
<p>This is all very good if you know the exact name of the city. What if all you know is the city starts with a <em>Z</em>?</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec10f853093293" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
c.execute("SELECT * FROM npi_data WHERE city LIKE 'Z%'")
result = c.fetchall()
print((result))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec10f853093293-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec10f853093293-2">2</div><div class="crayon-num" data-line="crayon-5bcf82e8ec10f853093293-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec10f853093293-1"><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-e">execute</span><span class="crayon-sy">(</span><span class="crayon-s">"SELECT * FROM npi_data WHERE city LIKE 'Z%'"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec10f853093293-2"><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-e">fetchall</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bcf82e8ec10f853093293-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p></p>
<p>The % symbol says any number of characters after <em>Z</em>. One more difference is, rather than doing an exact comparison using the <em>=</em> sign, we are using the <em>LIKE</em> keyword to tell SQL that we are not looking for an exact match, but a pattern search. This will print several hundred results.</p>
<p>What if we want to search for cities that start with Z and have exactly 4 letters?</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec114767653062" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
c.execute("SELECT * FROM npi_data WHERE city LIKE 'Z___'")
result = c.fetchall()
print((result))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec114767653062-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec114767653062-2">2</div><div class="crayon-num" data-line="crayon-5bcf82e8ec114767653062-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec114767653062-1"><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-e">execute</span><span class="crayon-sy">(</span><span class="crayon-s">"SELECT * FROM npi_data WHERE city LIKE 'Z___'"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec114767653062-2"><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-e">fetchall</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bcf82e8ec114767653062-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p></p>
<p>The underscore operator (_) in SQL is used to search for one character. So *Z___* (Z followed by 3x underscores ) will tell Sqlite to search for all cities that start with Z and have 4 characters. This will return cities like Zuni and Zion.</p>
<p>We can always narrow the search by looking for 4 lettered cities starting with <em>Z</em> in the state of Illinois.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec119878151098" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
c.execute("SELECT * FROM npi_data WHERE city LIKE 'Z___' and state='IL'")
result = c.fetchall()
print((result))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec119878151098-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec119878151098-2">2</div><div class="crayon-num" data-line="crayon-5bcf82e8ec119878151098-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec119878151098-1"><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-e">execute</span><span class="crayon-sy">(</span><span class="crayon-s">"SELECT * FROM npi_data WHERE city LIKE 'Z___' and state='IL'"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec119878151098-2"><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-e">fetchall</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bcf82e8ec119878151098-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p></p>
<p>To make it even more narrow focused, let&#8217;s extend the previous search. This time, we are looking for names that start with <em>Ma</em>.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec11e750524899" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
c.execute("SELECT * FROM npi_data WHERE city LIKE 'Z___' and state='IL' and name like 'MA%'")
result = c.fetchall()
print((result))

[('MARGARET  ROBINSON', '', 'ZION', 'IL'), ('MARTI  SNITTJER', '', 'ZION', 'IL'), 
('MARK E MITTEN', '', 'ZION', 'IL'), ('MAULIBEN  PATEL', '', 'ZION', 'IL'), 
('MARY ANN HOLEM', '', 'ZION', 'IL'), ('MARLA JOY SERDAR', '', 'ZION', 'IL')]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec11e750524899-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec11e750524899-2">2</div><div class="crayon-num" data-line="crayon-5bcf82e8ec11e750524899-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec11e750524899-4">4</div><div class="crayon-num" data-line="crayon-5bcf82e8ec11e750524899-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec11e750524899-6">6</div><div class="crayon-num" data-line="crayon-5bcf82e8ec11e750524899-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec11e750524899-1"><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-e">execute</span><span class="crayon-sy">(</span><span class="crayon-s">"SELECT * FROM npi_data WHERE city LIKE 'Z___' and state='IL' and name like 'MA%'"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec11e750524899-2"><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-sy">.</span><span class="crayon-e">fetchall</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bcf82e8ec11e750524899-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec11e750524899-4">&nbsp;</div><div class="crayon-line" id="crayon-5bcf82e8ec11e750524899-5"><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'MARGARET&nbsp;&nbsp;ROBINSON'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'ZION'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'IL'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">'MARTI&nbsp;&nbsp;SNITTJER'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'ZION'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'IL'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec11e750524899-6"><span class="crayon-sy">(</span><span class="crayon-s">'MARK E MITTEN'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'ZION'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'IL'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">'MAULIBEN&nbsp;&nbsp;PATEL'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'ZION'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'IL'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5bcf82e8ec11e750524899-7"><span class="crayon-sy">(</span><span class="crayon-s">'MARY ANN HOLEM'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'ZION'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'IL'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">'MARLA JOY SERDAR'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'ZION'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'IL'</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0023 seconds] -->
<p></p>
<p>One final thing before we close this section. You don&#8217;t need to depend on Sql for everything. You can fall down to Python as well. For example, you could have gotten all cities in Illinois, and then used Python to loop over the list, searching for names that start with <em>Ma</em>.</p>
<p>You can look at individual results using Python:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bcf82e8ec123874661514" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
result[0][0]

'MARGARET  ROBINSON'

result[0][0].split("  ")

['MARGARET', 'ROBINSON']</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bcf82e8ec123874661514-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec123874661514-2">2</div><div class="crayon-num" data-line="crayon-5bcf82e8ec123874661514-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec123874661514-4">4</div><div class="crayon-num" data-line="crayon-5bcf82e8ec123874661514-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bcf82e8ec123874661514-6">6</div><div class="crayon-num" data-line="crayon-5bcf82e8ec123874661514-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bcf82e8ec123874661514-1"><span class="crayon-v">result</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec123874661514-2">&nbsp;</div><div class="crayon-line" id="crayon-5bcf82e8ec123874661514-3"><span class="crayon-s">'MARGARET&nbsp;&nbsp;ROBINSON'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec123874661514-4">&nbsp;</div><div class="crayon-line" id="crayon-5bcf82e8ec123874661514-5"><span class="crayon-v">result</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">"&nbsp;&nbsp;"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bcf82e8ec123874661514-6">&nbsp;</div><div class="crayon-line" id="crayon-5bcf82e8ec123874661514-7"><span class="crayon-sy">[</span><span class="crayon-s">'MARGARET'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'ROBINSON'</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p></p>
<p>This is just to give you an idea. That&#8217;s it, see you in the practice session.</p>
<h2><strong>Why you need to practice</strong></h2>
<p>This short presentation goes over the need to practice coding. Skip it if you have seen it before.</p>
<p><iframe width="800" height="450" src="https://player.vimeo.com/video/147326379?title=0&amp;byline=0&amp;portrait=0" frameborder="0" webkitallowfullscreen="webkitallowfullscreen" mozallowfullscreen="mozallowfullscreen" allowfullscreen="allowfullscreen"></iframe></p>
<p>No transcript, instead download the presentation <a href="/wp-content/uploads/2015/12/Practice-Programming.ppt">here</a>.</p>
<p>Finally, time to practice our Sql.</p>
<h2>Practice Session</h2>
<p>Same repo as before, open up <em>Sql Practice.ipynb</em>.</p>
<p><iframe width="800" height="450" src="https://player.vimeo.com/video/147328834?title=0&amp;byline=0&amp;portrait=0" frameborder="0" webkitallowfullscreen="webkitallowfullscreen" mozallowfullscreen="mozallowfullscreen" allowfullscreen="allowfullscreen"></iframe></p>
<p>No transcript. Just open the practice file and follow the instructions. If you get stuck, the video has a few hints, but the biggest hint is: Everything in the practice session is based on what we&#8217;ve done before, so go over all the examples in this page, and you should be able to finish the practice session.</p>
<p><em>More data science lessons <a href="/data-science-lessons/">here</a>.</em></p>



	</div><!-- .entry-content -->

	
</article><!-- #post-## -->

	</main><!-- .site-main -->

	
</div><!-- .content-area -->


	<aside id="secondary" class="sidebar widget-area" role="complementary">
		<section id="search-4" class="widget widget_search">
<form role="search" method="get" class="search-form" action="/">
	<label>
		<span class="screen-reader-text">Search for:</span>
		<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
	</label>
	<button type="submit" class="search-submit"><span class="screen-reader-text">Search</span></button>
</form>
</section>	</aside><!-- .sidebar .widget-area -->

		</div><!-- .site-content -->

		<footer id="colophon" class="site-footer" role="contentinfo">
							<nav class="main-navigation" role="navigation" aria-label="Footer Primary Menu">
					<div class="menu-main-container"><ul id="menu-main-1" class="primary-menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-52"><a href="/articles/">Articles</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1533"><a href="/about/">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35"><a href="/contact/">Contact</a></li>
</ul></div>				</nav><!-- .main-navigation -->
			
			
			<div class="site-info">
								<span class="site-title"><a href="/" rel="home">Python For Engineers</a></span>
								<a href="https://wordpress.org/" class="imprint">
					Proudly powered by WordPress				</a>
			</div><!-- .site-info -->
		</footer><!-- .site-footer -->
	</div><!-- .site-inner -->
</div><!-- .site -->

<script type='text/javascript' src='/wp-content/themes/twentysixteen/js/skip-link-focus-fix.js?ver=20160816'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var screenReaderText = {"expand":"expand child menu","collapse":"collapse child menu"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/themes/twentysixteen/js/functions.js?ver=20160816'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var tve_dash_front = {"ajaxurl":"http:\/\/pythonforengineers.com\/wp-admin\/admin-ajax.php","force_ajax_send":"","is_crawler":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/thrive-visual-editor/thrive-dashboard/js/dist/frontend.min.js?ver=2.0.45'></script>
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.9.8'></script>
</body>
</html>
