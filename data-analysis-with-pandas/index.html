<!DOCTYPE html>
<html lang="en-US" class="no-js">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="http://gmpg.org/xfn/11">
		<script>(function(html){html.className = html.className.replace(/\bno-js\b/,'js')})(document.documentElement);</script>
<title>Data Analysis with Pandas &#8211; Python For Engineers</title>
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Python For Engineers &raquo; Feed" href="/feed/" />
<link rel="alternate" type="application/rss+xml" title="Python For Engineers &raquo; Comments Feed" href="/comments/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/pythonforengineers.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='crayon-css'  href='/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-github-css'  href='/wp-content/plugins/crayon-syntax-highlighter/themes/github/github.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='twentysixteen-fonts-css'  href='https://fonts.googleapis.com/css?family=Merriweather%3A400%2C700%2C900%2C400italic%2C700italic%2C900italic%7CMontserrat%3A400%2C700%7CInconsolata%3A400&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='genericons-css'  href='/wp-content/themes/twentysixteen/genericons/genericons.css?ver=3.4.1' type='text/css' media='all' />
<link rel='stylesheet' id='twentysixteen-style-css'  href='/wp-content/themes/twentysixteen/style.css?ver=4.9.8' type='text/css' media='all' />
<!--[if lt IE 10]>
<link rel='stylesheet' id='twentysixteen-ie-css'  href='http://pythonforengineers.com/wp-content/themes/twentysixteen/css/ie.css?ver=20160816' type='text/css' media='all' />
<![endif]-->
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentysixteen-ie8-css'  href='http://pythonforengineers.com/wp-content/themes/twentysixteen/css/ie8.css?ver=20160816' type='text/css' media='all' />
<![endif]-->
<!--[if lt IE 8]>
<link rel='stylesheet' id='twentysixteen-ie7-css'  href='http://pythonforengineers.com/wp-content/themes/twentysixteen/css/ie7.css?ver=20160816' type='text/css' media='all' />
<![endif]-->
<script type='text/javascript' src='/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/pythonforengineers.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='http://pythonforengineers.com/wp-content/themes/twentysixteen/js/html5.js?ver=3.7.3'></script>
<![endif]-->
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 4.9.8" />
<link rel="canonical" href="/data-analysis-with-pandas/" />
<link rel='shortlink' href='/?p=3006' />
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Fdata-analysis-with-pandas%2F" />
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Fdata-analysis-with-pandas%2F&#038;format=xml" />
		<style type="text/css" id="wp-custom-css">
			.site-info { display: None}		</style>
	</head>

<body class="page-template-default page page-id-3006">
<div id="page" class="site">
	<div class="site-inner">
		<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

		<header id="masthead" class="site-header" role="banner">
			<div class="site-header-main">
				<div class="site-branding">
					
											<p class="site-title"><a href="/" rel="home">Python For Engineers</a></p>
									</div><!-- .site-branding -->

									<button id="menu-toggle" class="menu-toggle">Menu</button>

					<div id="site-header-menu" class="site-header-menu">
													<nav id="site-navigation" class="main-navigation" role="navigation" aria-label="Primary Menu">
								<div class="menu-main-container"><ul id="menu-main" class="primary-menu"><li id="menu-item-52" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-52"><a href="/articles/">Articles</a></li>
<li id="menu-item-1533" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1533"><a href="/about/">About</a></li>
<li id="menu-item-35" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35"><a href="/contact/">Contact</a></li>
</ul></div>							</nav><!-- .main-navigation -->
						
											</div><!-- .site-header-menu -->
							</div><!-- .site-header-main -->

					</header><!-- .site-header -->

		<div id="content" class="site-content">

<div id="primary" class="content-area">
	<main id="main" class="site-main" role="main">
		
<article id="post-3006" class="post-3006 page type-page status-publish hentry">
	<header class="entry-header">
		<h1 class="entry-title">Data Analysis with Pandas</h1>	</header><!-- .entry-header -->

	
	<div class="entry-content">
		<p><a href="/python-for-scientists-and-engineers/"><strong>Intro: Start here</strong></a></p>
<p><a href="/installing-the-libraries-required-for-the-book/"><strong>Installing the libraries required for the book</strong></a></p>
<p><strong>Beginners Start Here:</strong><a href="/create-a-word-counter-in-python/"><strong> </strong></a></p>
<p style="padding-left: 30px;"><a href="/create-a-word-counter-in-python/"><strong>Create a Word Counter in Python</strong></a></p>
<p style="padding-left: 30px;"><a href="/an-introduction-to-numpy-and-matplotlib/"><strong>An introduction to Numpy and Matplotlib</strong></a></p>
<p style="padding-left: 30px;"><a href="/introduction-to-pandas/" target="_blank"><strong>Introduction to Pandas with Practical Examples (New)</strong></a></p>
<p><strong>Main Book</strong></p>
<p><a href="/image-and-video-processing-in-python/"><strong>Image and Video Processing in Python</strong></a></p>
<p><a href="/data-analysis-with-pandas/"><strong>Data Analysis with Pandas</strong></a></p>
<p><a href="/audio-and-digital-signal-processingdsp-in-python/"><strong>Audio and Digital Signal Processing (DSP)</strong></a></p>
<p><a href="/control-your-raspberry-pi-from-your-phone-tablet/"><strong>Control Your Raspberry Pi From Your Phone / Tablet</strong></a></p>
<p><strong>Machine Learning Section</strong></p>
<p style="padding-left: 30px;"><a href="/machine-learning-with-an-amazon-like-recommendation-engine/"><strong>Machine Learning with an Amazon like Recommendation Engine</strong></a></p>
<p><strong>Machine Learning New Stuff<br /></strong></p>
<p style="padding-left: 30px;"><strong> <a href="/machine-learning-for-complete-beginners/" target="_blank">Machine Learning For Complete Beginners:</a> </strong>Learn how to predict how many Titanic survivors using machine learning. No previous knowledge needed!</p>
<p style="padding-left: 30px;"><a href="/cross-validation-and-model-selection/" target="_blank"><strong>Cross Validation and Model Selection</strong></a>: In which we look at cross validation, and how to choose between different machine learning algorithms. Working with the Iris flower dataset and the Pima diabetes dataset.</p>
<p style="padding-left: 30px;"><strong>Natural Language Processing</strong></p>
<p style="padding-left: 30px;"><a href="/natural-language-processing-and-sentiment-analysis-with-python/"   target="_blank"><strong>0. Introduction to NLP and Sentiment Analysis</strong></a></p>
<p style="padding-left: 30px;"><strong><a href="/introduction-to-nltk-natural-language-processing-with-python/" target="_blank">1. Natural Language Processing with NTLK</a></strong></p>
<p style="padding-left: 30px;"><strong><a href="/intro-to-nltk-part-2/" target="_blank">2. Intro to NTLK, Part 2</a></strong></p>
<p style="padding-left: 30px;"><a href="/build-a-sentiment-analysis-app-with-movie-reviews/" target="_blank"><strong>3. Build a sentiment analysis program</strong></a></p>
<p style="padding-left: 30px;"><strong><a href="/practice-session-sentiment-analysis-with-twitter/" target="_blank">4. Sentiment Analysis with Twitter</a></strong></p>
<p style="padding-left: 30px;"><strong><span class="trail-end"><a href="/analysing-the-enron-email-corpus/"   target="_blank">5. Analysing the Enron Email Corpus</a></span></strong>: The Enron Email corpus has half a million files spread over 2.5 GB. When looking at data this size, the question is, where do you even start?</p>
<p style="padding-left: 30px;"><a href="/build-a-spam-filter/" target="_blank"><strong>6. Build a Spam Filter using the Enron Corpus</strong></a></p>
<hr /><hr />
<p style="padding-left: 30px;"></p>
<p>You must have seen in Chapter on plotting that Python can be used to parse csv files. You might also have noted that it is fairly painful. While there are libraries like <em>csv_reader()</em>, they still aren&#8217;t perfect. You still have to do  a lot of stuff manually.</p>
<p>Enter Pandas, which is a great library for data analysis. It is quite high level, so you don&#8217;t have to muck about with low level details, unless you really want to.</p>
<p>If you are dealing with complicated or large datasets, seriously consider Pandas. It is based on numpy/scipy, sort of a superset of it. But it gives you a lot of powerful features, like read directly from a Microsoft Excel file, do data joins (like you would do in SQL) etc, some of which features we will go over.</p>
<p>Just one more thing before we continue. Pandas has two basic data structures: Series and Dataframes.</p>
<p>Series is like numpy&#8217;s array/dictionary, though it comes with a lot of extra features. Dataframes is a two dimensional data structure that contains both column and row information, like the fields of an Excel file. Remember an Excel file has rows and columns, and an optional header field. All of this data can be represented in a Dataframe. That&#8217;s what we&#8217;ll use in our examples below.</p>
<h2>Installing pandas</h2>
<p>You should get Pandas if you installed Anaconda, as recommended.</p>
<p><em>Note to people without a graphical interface: If you can&#8217;t view the graphs because you have no GUI, you can save the graphs instead. <a href="http://stackoverflow.com/questions/9622163/save-plot-to-image-file-instead-of-displaying-it-using-matplotlib">See here for details</a>.</em></p>
<h2>Analyse obesity in England</h2>
<p>I&#8217;m using the 2014 data from here:</p>
<p><a href="http://data.gov.uk/dataset/statistics_on_obesity_physical_activity_and_diet_england">http://data.gov.uk/dataset/statistics_on_obesity_physical_activity_and_diet_england</a></p>
<p>I&#8217;ll also put it in the Github directory, so you don&#8217;t have to download it. Make sure you open the file in Excel (or Openoffice) and view it, so you know what we&#8217;re talking about. Do that now, and have a look at the different sections. Especially section 7.1 and 7.2, as that&#8217;s what we&#8217;ll focus on.</p>
<p>Let&#8217;s get started then.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08816269780859" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import pandas as pd
import matplotlib.pyplot as plt
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08816269780859-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08816269780859-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d08816269780859-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08816269780859-1"><span class="crayon-e">import </span><span class="crayon-e">pandas </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">pd</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08816269780859-2"><span class="crayon-e">import </span><span class="crayon-v">matplotlib</span><span class="crayon-sy">.</span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">plt</span></div><div class="crayon-line" id="crayon-5bd0ae8d08816269780859-3">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p>Pandas is imported as <em>pd</em> to save typing, in the same way we import numpy as <em>np</em>.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08825706873822" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
data = pd.ExcelFile("Obes-phys-acti-diet-eng-2014-tab.xls")
print(data.sheet_names)
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08825706873822-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08825706873822-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d08825706873822-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08825706873822-1"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">ExcelFile</span><span class="crayon-sy">(</span><span class="crayon-s">"Obes-phys-acti-diet-eng-2014-tab.xls"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08825706873822-2"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">sheet_names</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bd0ae8d08825706873822-3">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p>We are opening the <em>xls</em> file. The great thing about pandas is that you can open Excel files directly. Normally, most libraries can only work with <em>csv</em> files. We then print all the sheet names.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d0882b643030367" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
['Chapter 7', '7.1', '7.2', '7.3', '7.4', '7.5', '7.6', '7.7', '7.8', '7.9', '7.10']
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d0882b643030367-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d0882b643030367-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d0882b643030367-1"><span class="crayon-sy">[</span><span class="crayon-s">'Chapter 7'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'7.1'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'7.2'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'7.3'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'7.4'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'7.5'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'7.6'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'7.7'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'7.8'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'7.9'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'7.10'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d0882b643030367-2">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p>For those of you not comfortable with Excel, a sheet is one &#8220;page&#8221;, as it were, of data. Rather than having all the data in one huge unmanageable sheet, users break the data into multiple sheets. Above, we printed all the available sheets.</p>
<h3>Section 7.1: Obesity by gender</h3>
<p>Let&#8217;s have a look at sheet 1:</p>
<p><img src="/wp-content/uploads/2017/04/pandas1.jpg" alt="" class="aligncenter size-full wp-image-3009" width="960" height="554" srcset="/wp-content/uploads/2017/04/pandas1.jpg 960w, /wp-content/uploads/2017/04/pandas1-300x173.jpg 300w, /wp-content/uploads/2017/04/pandas1-768x443.jpg 768w" sizes="(max-width: 709px) 85vw, (max-width: 909px) 67vw, (max-width: 1362px) 62vw, 840px" /></p>
<p>There are four columns: <em>Year</em>, <em>total</em>, <em>males</em> and <em>females</em>. The <em>Year</em> column doesn&#8217;t have a header- if you look at line 5, you will see the header for year is empty.</p>
<p>I&#8217;ll show you two ways to read in data. In the first one, you define the header columns yourself.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08831798942610" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# Define the columns to be read
columns1 = ['year', 'total', 'males', 'females']

</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08831798942610-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08831798942610-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d08831798942610-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08831798942610-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08831798942610-1"><span class="crayon-p"># Define the columns to be read</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08831798942610-2"><span class="crayon-v">columns1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'year'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'total'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'males'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'females'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5bd0ae8d08831798942610-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08831798942610-4">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p>So I&#8217;m defining a list with four header entries: &#8216;year&#8217;, &#8216;total&#8217;, &#8216;males&#8217; and &#8216;females&#8217;.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08836484020487" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
data_gender = data.parse(u'7.1', skiprows=4, skipfooter=14, names=columns1)
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08836484020487-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08836484020487-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08836484020487-1"><span class="crayon-v">data_gender</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-e">parse</span><span class="crayon-sy">(</span><span class="crayon-i">u</span><span class="crayon-s">'7.1'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">skiprows</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">skipfooter</span><span class="crayon-o">=</span><span class="crayon-cn">14</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-o">=</span><span class="crayon-v">columns1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08836484020487-2">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p>We read sheet <em>7.1</em>. If you look at the actual sheet, the top 4 and bottom 14 rows contain useless info, so we skip it (<em>skiprows=4, skipfooter=14,</em> ). Finally, we tell pandas to name the column headers using our list <em>names=columns1</em> .</p>
<p>We then print <em>data_gender</em>.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d0883b568026345" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
print(data_gender)
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d0883b568026345-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d0883b568026345-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d0883b568026345-1"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">data_gender</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d0883b568026345-2">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08840876377181" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
       year  total  males  females
0       NaN    NaN    NaN      NaN
1   2002/03   1275    427      848
2   2003/04   1711    498     1213
3   2004/05   2035    589     1442
 &lt; snip &gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08840876377181-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08840876377181-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d08840876377181-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08840876377181-4">4</div><div class="crayon-num" data-line="crayon-5bd0ae8d08840876377181-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08840876377181-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08840876377181-1"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">year&nbsp;&nbsp;</span><span class="crayon-e">total&nbsp;&nbsp;</span><span class="crayon-e">males&nbsp;&nbsp;</span><span class="crayon-i">females</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08840876377181-2"><span class="crayon-cn">0</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">NaN&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">NaN&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">NaN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">NaN</span></div><div class="crayon-line" id="crayon-5bd0ae8d08840876377181-3"><span class="crayon-cn">1</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">2002</span><span class="crayon-o">/</span><span class="crayon-cn">03</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">1275</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">427</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">848</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08840876377181-4"><span class="crayon-cn">2</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">2003</span><span class="crayon-o">/</span><span class="crayon-cn">04</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">1711</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">498</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">1213</span></div><div class="crayon-line" id="crayon-5bd0ae8d08840876377181-5"><span class="crayon-cn">3</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">2004</span><span class="crayon-o">/</span><span class="crayon-cn">05</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">2035</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">589</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">1442</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08840876377181-6"><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">snip</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p></p>
<p>&nbsp;</p>
<p>If you look at the entry for 0, it is <em>NaN</em>.  Why&#8217;s that? Look at the original spreadsheet. There is an empty space on line 6, to make the sheet easier to read. Since it is empty, it is read as Not A Number (NaN) by pandas. How do we get rid of it? Easy.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08845556559544" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# Remove the N/A from the data
data_gender.dropna(inplace = True)
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08845556559544-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08845556559544-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d08845556559544-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08845556559544-1"><span class="crayon-p"># Remove the N/A from the data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08845556559544-2"><span class="crayon-v">data_gender</span><span class="crayon-sy">.</span><span class="crayon-e">dropna</span><span class="crayon-sy">(</span><span class="crayon-v">inplace</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bd0ae8d08845556559544-3">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p>Using the inbuilt <em>dropna()</em> function, of course. <em>inplace = True</em> means modify the existing Dataframe. If we look at the output again:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d0884a662194655" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
       year  total  males  females
1   2002/03   1275    427      848
2   2003/04   1711    498     1213
3   2004/05   2035    589     1442

 &lt; snip &gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d0884a662194655-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d0884a662194655-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d0884a662194655-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d0884a662194655-4">4</div><div class="crayon-num" data-line="crayon-5bd0ae8d0884a662194655-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d0884a662194655-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d0884a662194655-1"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">year&nbsp;&nbsp;</span><span class="crayon-e">total&nbsp;&nbsp;</span><span class="crayon-e">males&nbsp;&nbsp;</span><span class="crayon-i">females</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d0884a662194655-2"><span class="crayon-cn">1</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">2002</span><span class="crayon-o">/</span><span class="crayon-cn">03</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">1275</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">427</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">848</span></div><div class="crayon-line" id="crayon-5bd0ae8d0884a662194655-3"><span class="crayon-cn">2</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">2003</span><span class="crayon-o">/</span><span class="crayon-cn">04</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">1711</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">498</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">1213</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d0884a662194655-4"><span class="crayon-cn">3</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">2004</span><span class="crayon-o">/</span><span class="crayon-cn">05</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-cn">2035</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">589</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">1442</span></div><div class="crayon-line" id="crayon-5bd0ae8d0884a662194655-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d0884a662194655-6"><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">snip</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p></p>
<p>&nbsp;</p>
<p>we see the <em>NaN</em> values are now gone. There is another problem, though. We have an index at the beginning (the first column, going 1,2,3&#8230;.). We don&#8217;t need an index. Instead, we want the year to be the index. Let&#8217;s fix that next.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d0884f450560051" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
data_gender.set_index('year', inplace=True)
print(data_gender)
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d0884f450560051-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d0884f450560051-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d0884f450560051-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d0884f450560051-1"><span class="crayon-v">data_gender</span><span class="crayon-sy">.</span><span class="crayon-e">set_index</span><span class="crayon-sy">(</span><span class="crayon-s">'year'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d0884f450560051-2"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">data_gender</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bd0ae8d0884f450560051-3">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08855418599770" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
total  males  females
year
2002/03   1275    427      848
2003/04   1711    498     1213
2004/05   2035    589     1442

</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08855418599770-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08855418599770-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d08855418599770-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08855418599770-4">4</div><div class="crayon-num" data-line="crayon-5bd0ae8d08855418599770-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08855418599770-6">6</div><div class="crayon-num" data-line="crayon-5bd0ae8d08855418599770-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08855418599770-1"><span class="crayon-i">total</span> <span class="crayon-h"> </span><span class="crayon-i">males</span> <span class="crayon-h"> </span><span class="crayon-e">females</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08855418599770-2"><span class="crayon-i">year</span></div><div class="crayon-line" id="crayon-5bd0ae8d08855418599770-3"><span class="crayon-cn">2002</span><span class="crayon-o">/</span><span class="crayon-cn">03</span>  <span class="crayon-h"> </span><span class="crayon-cn">1275</span>   <span class="crayon-h"> </span><span class="crayon-cn">427</span>     <span class="crayon-h"> </span><span class="crayon-cn">848</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08855418599770-4"><span class="crayon-cn">2003</span><span class="crayon-o">/</span><span class="crayon-cn">04</span>  <span class="crayon-h"> </span><span class="crayon-cn">1711</span>   <span class="crayon-h"> </span><span class="crayon-cn">498</span>    <span class="crayon-h"> </span><span class="crayon-cn">1213</span></div><div class="crayon-line" id="crayon-5bd0ae8d08855418599770-5"><span class="crayon-cn">2004</span><span class="crayon-o">/</span><span class="crayon-cn">05</span>  <span class="crayon-h"> </span><span class="crayon-cn">2035</span>   <span class="crayon-h"> </span><span class="crayon-cn">589</span>    <span class="crayon-h"> </span><span class="crayon-cn">1442</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08855418599770-6">&nbsp;</div><div class="crayon-line" id="crayon-5bd0ae8d08855418599770-7">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p></p>
<p>That&#8217;s better.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08859315761817" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# Plot all
data_gender.plot()
plt.show()
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08859315761817-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08859315761817-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d08859315761817-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08859315761817-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08859315761817-1"><span class="crayon-p"># Plot all</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08859315761817-2"><span class="crayon-v">data_gender</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bd0ae8d08859315761817-3"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08859315761817-4">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p><img src="/wp-content/uploads/2017/04/pandas2.png" alt="" class="aligncenter size-full wp-image-3010" width="800" height="600" srcset="/wp-content/uploads/2017/04/pandas2.png 800w, /wp-content/uploads/2017/04/pandas2-300x225.png 300w, /wp-content/uploads/2017/04/pandas2-768x576.png 768w" sizes="(max-width: 800px) 85vw, 800px" /></p>
<p>We can see that while obesity for men has gone up, obesity for women has gone up more strongly.</p>
<h3>Section 7.2: Obesity by age</h3>
<p><img src="/wp-content/uploads/2017/04/pandas3.jpg" alt="" class="aligncenter size-full wp-image-3011" width="605" height="977" srcset="/wp-content/uploads/2017/04/pandas3.jpg 605w, /wp-content/uploads/2017/04/pandas3-186x300.jpg 186w" sizes="(max-width: 605px) 85vw, 605px" /></p>
<p>We will read the  data slightly differently this time. Last time, we defined the headers ourself. This time, we&#8217;ll let pandas pick them up.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d0885f858664651" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# Read 2nd section, by age
data_age  = data.parse('7.2', skiprows=4, skipfooter=14)
print(data_age)
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d0885f858664651-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d0885f858664651-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d0885f858664651-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d0885f858664651-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d0885f858664651-1"><span class="crayon-p"># Read 2nd section, by age</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d0885f858664651-2"><span class="crayon-v">data</span><span class="crayon-sy">_</span>age <span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-e">parse</span><span class="crayon-sy">(</span><span class="crayon-s">'7.2'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">skiprows</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">skipfooter</span><span class="crayon-o">=</span><span class="crayon-cn">14</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bd0ae8d0885f858664651-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">data_age</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d0885f858664651-4">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08863674526852" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Unnamed: 0  Total  Under 16  16-24  25-34  35-44  45-54  55-64  65-74
0         NaN    NaN       NaN    NaN    NaN    NaN    NaN    NaN    NaN
1     2002/03   1275       400     65    136    289    216     94     52

</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08863674526852-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08863674526852-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d08863674526852-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08863674526852-4">4</div><div class="crayon-num" data-line="crayon-5bd0ae8d08863674526852-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08863674526852-1"><span class="crayon-v">Unnamed</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0</span> <span class="crayon-h"> </span><span class="crayon-i">Total</span> <span class="crayon-h"> </span><span class="crayon-i">Under</span><span class="crayon-h"> </span><span class="crayon-cn">16</span> <span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-o">-</span><span class="crayon-cn">24</span> <span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-o">-</span><span class="crayon-cn">34</span> <span class="crayon-h"> </span><span class="crayon-cn">35</span><span class="crayon-o">-</span><span class="crayon-cn">44</span> <span class="crayon-h"> </span><span class="crayon-cn">45</span><span class="crayon-o">-</span><span class="crayon-cn">54</span> <span class="crayon-h"> </span><span class="crayon-cn">55</span><span class="crayon-o">-</span><span class="crayon-cn">64</span> <span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-o">-</span><span class="crayon-cn">74</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08863674526852-2"><span class="crayon-cn">0</span>        <span class="crayon-h"> </span><span class="crayon-i">NaN</span>   <span class="crayon-h"> </span><span class="crayon-i">NaN</span>      <span class="crayon-h"> </span><span class="crayon-i">NaN</span>   <span class="crayon-h"> </span><span class="crayon-i">NaN</span>   <span class="crayon-h"> </span><span class="crayon-i">NaN</span>   <span class="crayon-h"> </span><span class="crayon-i">NaN</span>   <span class="crayon-h"> </span><span class="crayon-i">NaN</span>   <span class="crayon-h"> </span><span class="crayon-i">NaN</span>   <span class="crayon-h"> </span><span class="crayon-i">NaN</span></div><div class="crayon-line" id="crayon-5bd0ae8d08863674526852-3"><span class="crayon-cn">1</span>    <span class="crayon-h"> </span><span class="crayon-cn">2002</span><span class="crayon-o">/</span><span class="crayon-cn">03</span>  <span class="crayon-h"> </span><span class="crayon-cn">1275</span>      <span class="crayon-h"> </span><span class="crayon-cn">400</span>    <span class="crayon-h"> </span><span class="crayon-cn">65</span>   <span class="crayon-h"> </span><span class="crayon-cn">136</span>   <span class="crayon-h"> </span><span class="crayon-cn">289</span>   <span class="crayon-h"> </span><span class="crayon-cn">216</span>    <span class="crayon-h"> </span><span class="crayon-cn">94</span>    <span class="crayon-h"> </span><span class="crayon-cn">52</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08863674526852-4">&nbsp;</div><div class="crayon-line" id="crayon-5bd0ae8d08863674526852-5">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p></p>
<p>If you remember, the year column didn&#8217;t have a header, which is why pandas names it <em>Unnamed</em>. Let&#8217;s rename it:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08868333509727" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# Rename unames to year
data_age.rename(columns={'Unnamed: 0': 'Year'}, inplace=True)
print(data_age)
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08868333509727-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08868333509727-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d08868333509727-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08868333509727-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08868333509727-1"><span class="crayon-p"># Rename unames to year</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08868333509727-2"><span class="crayon-v">data_age</span><span class="crayon-sy">.</span><span class="crayon-e">rename</span><span class="crayon-sy">(</span><span class="crayon-v">columns</span><span class="crayon-o">=</span><span class="crayon-sy">{</span><span class="crayon-s">'Unnamed: 0'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Year'</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bd0ae8d08868333509727-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">data_age</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08868333509727-4">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d0886d444275416" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Year  Total  Under 16  16-24  25-34  35-44  45-54  55-64  65-74
0       NaN    NaN       NaN    NaN    NaN    NaN    NaN    NaN    NaN
1   2002/03   1275       400     65    136    289    216     94     52

</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d0886d444275416-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d0886d444275416-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d0886d444275416-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d0886d444275416-4">4</div><div class="crayon-num" data-line="crayon-5bd0ae8d0886d444275416-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d0886d444275416-1"><span class="crayon-i">Year</span> <span class="crayon-h"> </span><span class="crayon-i">Total</span> <span class="crayon-h"> </span><span class="crayon-i">Under</span><span class="crayon-h"> </span><span class="crayon-cn">16</span> <span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-o">-</span><span class="crayon-cn">24</span> <span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-o">-</span><span class="crayon-cn">34</span> <span class="crayon-h"> </span><span class="crayon-cn">35</span><span class="crayon-o">-</span><span class="crayon-cn">44</span> <span class="crayon-h"> </span><span class="crayon-cn">45</span><span class="crayon-o">-</span><span class="crayon-cn">54</span> <span class="crayon-h"> </span><span class="crayon-cn">55</span><span class="crayon-o">-</span><span class="crayon-cn">64</span> <span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-o">-</span><span class="crayon-cn">74</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d0886d444275416-2"><span class="crayon-cn">0</span>      <span class="crayon-h"> </span><span class="crayon-i">NaN</span>   <span class="crayon-h"> </span><span class="crayon-i">NaN</span>      <span class="crayon-h"> </span><span class="crayon-i">NaN</span>   <span class="crayon-h"> </span><span class="crayon-i">NaN</span>   <span class="crayon-h"> </span><span class="crayon-i">NaN</span>   <span class="crayon-h"> </span><span class="crayon-i">NaN</span>   <span class="crayon-h"> </span><span class="crayon-i">NaN</span>   <span class="crayon-h"> </span><span class="crayon-i">NaN</span>   <span class="crayon-h"> </span><span class="crayon-i">NaN</span></div><div class="crayon-line" id="crayon-5bd0ae8d0886d444275416-3"><span class="crayon-cn">1</span>  <span class="crayon-h"> </span><span class="crayon-cn">2002</span><span class="crayon-o">/</span><span class="crayon-cn">03</span>  <span class="crayon-h"> </span><span class="crayon-cn">1275</span>      <span class="crayon-h"> </span><span class="crayon-cn">400</span>    <span class="crayon-h"> </span><span class="crayon-cn">65</span>   <span class="crayon-h"> </span><span class="crayon-cn">136</span>   <span class="crayon-h"> </span><span class="crayon-cn">289</span>   <span class="crayon-h"> </span><span class="crayon-cn">216</span>    <span class="crayon-h"> </span><span class="crayon-cn">94</span>    <span class="crayon-h"> </span><span class="crayon-cn">52</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d0886d444275416-4">&nbsp;</div><div class="crayon-line" id="crayon-5bd0ae8d0886d444275416-5">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p></p>
<p>That&#8217;s better. Let&#8217;s drop the Nan and set the index to year.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08872304339022" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# Drop empties and reset index
data_age.dropna(inplace=True)
data_age.set_index('Year', inplace=True)
print(data_age)
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08872304339022-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08872304339022-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d08872304339022-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08872304339022-4">4</div><div class="crayon-num" data-line="crayon-5bd0ae8d08872304339022-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08872304339022-1"><span class="crayon-p"># Drop empties and reset index</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08872304339022-2"><span class="crayon-v">data_age</span><span class="crayon-sy">.</span><span class="crayon-e">dropna</span><span class="crayon-sy">(</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bd0ae8d08872304339022-3"><span class="crayon-v">data_age</span><span class="crayon-sy">.</span><span class="crayon-e">set_index</span><span class="crayon-sy">(</span><span class="crayon-s">'Year'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08872304339022-4"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">data_age</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bd0ae8d08872304339022-5">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08877724239841" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Total  Under 16  16-24  25-34  35-44  45-54  55-64  65-74
Year
2002/03   1275       400     65    136    289    216     94     52
2003/04   1711       579     67    174    391    273    151     52

</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08877724239841-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08877724239841-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d08877724239841-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08877724239841-4">4</div><div class="crayon-num" data-line="crayon-5bd0ae8d08877724239841-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08877724239841-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08877724239841-1"><span class="crayon-i">Total</span> <span class="crayon-h"> </span><span class="crayon-i">Under</span><span class="crayon-h"> </span><span class="crayon-cn">16</span> <span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-o">-</span><span class="crayon-cn">24</span> <span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-o">-</span><span class="crayon-cn">34</span> <span class="crayon-h"> </span><span class="crayon-cn">35</span><span class="crayon-o">-</span><span class="crayon-cn">44</span> <span class="crayon-h"> </span><span class="crayon-cn">45</span><span class="crayon-o">-</span><span class="crayon-cn">54</span> <span class="crayon-h"> </span><span class="crayon-cn">55</span><span class="crayon-o">-</span><span class="crayon-cn">64</span> <span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-o">-</span><span class="crayon-cn">74</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08877724239841-2"><span class="crayon-i">Year</span></div><div class="crayon-line" id="crayon-5bd0ae8d08877724239841-3"><span class="crayon-cn">2002</span><span class="crayon-o">/</span><span class="crayon-cn">03</span>  <span class="crayon-h"> </span><span class="crayon-cn">1275</span>      <span class="crayon-h"> </span><span class="crayon-cn">400</span>    <span class="crayon-h"> </span><span class="crayon-cn">65</span>   <span class="crayon-h"> </span><span class="crayon-cn">136</span>   <span class="crayon-h"> </span><span class="crayon-cn">289</span>   <span class="crayon-h"> </span><span class="crayon-cn">216</span>    <span class="crayon-h"> </span><span class="crayon-cn">94</span>    <span class="crayon-h"> </span><span class="crayon-cn">52</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08877724239841-4"><span class="crayon-cn">2003</span><span class="crayon-o">/</span><span class="crayon-cn">04</span>  <span class="crayon-h"> </span><span class="crayon-cn">1711</span>      <span class="crayon-h"> </span><span class="crayon-cn">579</span>    <span class="crayon-h"> </span><span class="crayon-cn">67</span>   <span class="crayon-h"> </span><span class="crayon-cn">174</span>   <span class="crayon-h"> </span><span class="crayon-cn">391</span>   <span class="crayon-h"> </span><span class="crayon-cn">273</span>   <span class="crayon-h"> </span><span class="crayon-cn">151</span>    <span class="crayon-h"> </span><span class="crayon-cn">52</span></div><div class="crayon-line" id="crayon-5bd0ae8d08877724239841-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08877724239841-6">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0010 seconds] -->
<p></p>
<p>Let&#8217;s plot all the ages first.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d0887c391426164" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
data_age.plot()
plt.show()
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d0887c391426164-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d0887c391426164-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d0887c391426164-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d0887c391426164-1"><span class="crayon-v">data_age</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d0887c391426164-2"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bd0ae8d0887c391426164-3">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p><img src="/wp-content/uploads/2017/04/pandas7.png" alt="" class="aligncenter size-full wp-image-3012" width="800" height="597" srcset="/wp-content/uploads/2017/04/pandas7.png 800w, /wp-content/uploads/2017/04/pandas7-300x224.png 300w, /wp-content/uploads/2017/04/pandas7-768x573.png 768w" sizes="(max-width: 800px) 85vw, 800px" /></p>
<p>You see a big problem: The <em>Total</em> column is huge and suppresses the other graphs. So we need to get rid of it to make the graph clearer.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08880295453928" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# Plotting everything cause total to override everything. So drop it.

# Drop the total column and plot
data_age_minus_total = data_age.drop('Total', axis = 1)

</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08880295453928-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08880295453928-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d08880295453928-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08880295453928-4">4</div><div class="crayon-num" data-line="crayon-5bd0ae8d08880295453928-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08880295453928-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08880295453928-1"><span class="crayon-p"># Plotting everything cause total to override everything. So drop it.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08880295453928-2">&nbsp;</div><div class="crayon-line" id="crayon-5bd0ae8d08880295453928-3"><span class="crayon-p"># Drop the total column and plot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08880295453928-4"><span class="crayon-v">data_age_minus_total</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data_age</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-s">'Total'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bd0ae8d08880295453928-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08880295453928-6">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p>The <em>drop()</em> function can drop entries from a table. Here, we are dropping the <em>Total</em> column.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08884039807477" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
data_age_minus_total.plot()
plt.show()
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08884039807477-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08884039807477-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d08884039807477-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08884039807477-1"><span class="crayon-v">data_age_minus_total</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08884039807477-2"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bd0ae8d08884039807477-3">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p><img src="/wp-content/uploads/2017/04/pandas4.png" alt="" class="aligncenter size-full wp-image-3013" width="800" height="600" srcset="/wp-content/uploads/2017/04/pandas4.png 800w, /wp-content/uploads/2017/04/pandas4-300x225.png 300w, /wp-content/uploads/2017/04/pandas4-768x576.png 768w" sizes="(max-width: 800px) 85vw, 800px" /></p>
<p>We can quickly see that the age groups 35-44 and 45-54 have had the highest obesity growth.</p>
<p>What if we want to compare age groups? How do children compare to adults?</p>
<p>In Pandas, you can view any column by doing <em>data_age[column_name]</em>.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d0888a569200726" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
print(data_age['Under 16'])
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d0888a569200726-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d0888a569200726-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d0888a569200726-1"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">data_age</span><span class="crayon-sy">[</span><span class="crayon-s">'Under 16'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d0888a569200726-2">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d0888e864317335" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Year
2002/03    400
2003/04    579
2004/05    547
2005/06    583

</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d0888e864317335-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d0888e864317335-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d0888e864317335-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d0888e864317335-4">4</div><div class="crayon-num" data-line="crayon-5bd0ae8d0888e864317335-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d0888e864317335-6">6</div><div class="crayon-num" data-line="crayon-5bd0ae8d0888e864317335-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d0888e864317335-1"><span class="crayon-i">Year</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d0888e864317335-2"><span class="crayon-cn">2002</span><span class="crayon-o">/</span><span class="crayon-cn">03</span>   <span class="crayon-h"> </span><span class="crayon-cn">400</span></div><div class="crayon-line" id="crayon-5bd0ae8d0888e864317335-3"><span class="crayon-cn">2003</span><span class="crayon-o">/</span><span class="crayon-cn">04</span>   <span class="crayon-h"> </span><span class="crayon-cn">579</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d0888e864317335-4"><span class="crayon-cn">2004</span><span class="crayon-o">/</span><span class="crayon-cn">05</span>   <span class="crayon-h"> </span><span class="crayon-cn">547</span></div><div class="crayon-line" id="crayon-5bd0ae8d0888e864317335-5"><span class="crayon-cn">2005</span><span class="crayon-o">/</span><span class="crayon-cn">06</span>   <span class="crayon-h"> </span><span class="crayon-cn">583</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d0888e864317335-6">&nbsp;</div><div class="crayon-line" id="crayon-5bd0ae8d0888e864317335-7">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p>This gives the data for just the under 16s. We can plot any age group this way.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08893210440474" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
#Plot children vs adults
data_age['Under 16'].plot(label = "Under 16")
data_age['25-34'].plot(label = "25-34")
plt.legend(loc="upper right")
plt.show()

</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08893210440474-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08893210440474-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d08893210440474-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08893210440474-4">4</div><div class="crayon-num" data-line="crayon-5bd0ae8d08893210440474-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08893210440474-6">6</div><div class="crayon-num" data-line="crayon-5bd0ae8d08893210440474-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08893210440474-1"><span class="crayon-p">#Plot children vs adults</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08893210440474-2"><span class="crayon-v">data_age</span><span class="crayon-sy">[</span><span class="crayon-s">'Under 16'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">label</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"Under 16"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bd0ae8d08893210440474-3"><span class="crayon-v">data_age</span><span class="crayon-sy">[</span><span class="crayon-s">'25-34'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">label</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"25-34"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08893210440474-4"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">legend</span><span class="crayon-sy">(</span><span class="crayon-v">loc</span><span class="crayon-o">=</span><span class="crayon-s">"upper right"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bd0ae8d08893210440474-5"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08893210440474-6">&nbsp;</div><div class="crayon-line" id="crayon-5bd0ae8d08893210440474-7">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p></p>
<p><img src="/wp-content/uploads/2017/04/pandas5.png" alt="" class="aligncenter size-full wp-image-3014" width="800" height="600" srcset="/wp-content/uploads/2017/04/pandas5.png 800w, /wp-content/uploads/2017/04/pandas5-300x225.png 300w, /wp-content/uploads/2017/04/pandas5-768x576.png 768w" sizes="(max-width: 800px) 85vw, 800px" /></p>
<p>We see that while children&#8217;s obesity has gone down, that for adults has ballooned. Maybe adults should start following the advice they give to children?</p>
<h2>Movie Lens</h2>
<p>The movie lens database is a collection of data based on users reviews of movies. It is one of the most popular open datasets out there. Download it from http://grouplens.org/datasets/movielens/, downloading the 100K version.</p>
<p>It is also different that the data isn&#8217;t in an Excel format, but plain text. This makes it easy to parse. Now, we have seen that Python pandas makes parsing Excel files easy as well, but many programming languages don&#8217;t have this feature.</p>
<p>Download the data and have a look at it. There is a large amount of data, and we will only work with a small subset. If you want to know the details of the files, they are in the Readme.</p>
<p>In a text editor, open the first file we will work with, <em>u.item</em>:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08899333522104" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
1|Toy Story (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?Toy%20Story%20(1995)|0|0|0|1|1|1|0|0|0|0|0|0|0|0|0|0|0|0|0
2|GoldenEye (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?GoldenEye%20(1995)|0|1|1|0|0|0|0|0|0|0|0|0|0|0|0|0|1|0|0
3|Four Rooms (1995)|01-Jan-1995||http://us.imdb.com/M/title-exact?Four%20Rooms%20(1995)|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|1|0|0
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08899333522104-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08899333522104-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d08899333522104-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08899333522104-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08899333522104-1"><span class="crayon-cn">1</span><span class="crayon-o">|</span><span class="crayon-e">Toy </span><span class="crayon-e">Story</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1995</span><span class="crayon-sy">)</span><span class="crayon-o">|</span><span class="crayon-cn">01</span><span class="crayon-o">-</span><span class="crayon-v">Jan</span><span class="crayon-o">-</span><span class="crayon-cn">1995</span><span class="crayon-o">||</span><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//us.imdb.com/M/title-exact?Toy%20Story%20(1995)|0|0|0|1|1|1|0|0|0|0|0|0|0|0|0|0|0|0|0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08899333522104-2"><span class="crayon-cn">2</span><span class="crayon-o">|</span><span class="crayon-e">GoldenEye</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1995</span><span class="crayon-sy">)</span><span class="crayon-o">|</span><span class="crayon-cn">01</span><span class="crayon-o">-</span><span class="crayon-v">Jan</span><span class="crayon-o">-</span><span class="crayon-cn">1995</span><span class="crayon-o">||</span><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//us.imdb.com/M/title-exact?GoldenEye%20(1995)|0|1|1|0|0|0|0|0|0|0|0|0|0|0|0|0|1|0|0</span></div><div class="crayon-line" id="crayon-5bd0ae8d08899333522104-3"><span class="crayon-cn">3</span><span class="crayon-o">|</span><span class="crayon-e">Four </span><span class="crayon-e">Rooms</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1995</span><span class="crayon-sy">)</span><span class="crayon-o">|</span><span class="crayon-cn">01</span><span class="crayon-o">-</span><span class="crayon-v">Jan</span><span class="crayon-o">-</span><span class="crayon-cn">1995</span><span class="crayon-o">||</span><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-c">//us.imdb.com/M/title-exact?Four%20Rooms%20(1995)|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|1|0|0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08899333522104-4">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p></p>
<p>It contains the data movie id, movie name, release date, imdb.com link, and a series of flags for genre. These are separated by a pipe ( <em>|</em> ).<br />
I will only use the first two of the entries (movie id and name).<br />
Open <em>u.user</em>:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d0889e074556468" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
1|24|M|technician|85711
2|53|F|other|94043
3|23|M|writer|32067
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d0889e074556468-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d0889e074556468-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d0889e074556468-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d0889e074556468-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d0889e074556468-1"><span class="crayon-cn">1</span><span class="crayon-o">|</span><span class="crayon-cn">24</span><span class="crayon-o">|</span><span class="crayon-v">M</span><span class="crayon-o">|</span><span class="crayon-v">technician</span><span class="crayon-o">|</span><span class="crayon-cn">85711</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d0889e074556468-2"><span class="crayon-cn">2</span><span class="crayon-o">|</span><span class="crayon-cn">53</span><span class="crayon-o">|</span><span class="crayon-v">F</span><span class="crayon-o">|</span><span class="crayon-v">other</span><span class="crayon-o">|</span><span class="crayon-cn">94043</span></div><div class="crayon-line" id="crayon-5bd0ae8d0889e074556468-3"><span class="crayon-cn">3</span><span class="crayon-o">|</span><span class="crayon-cn">23</span><span class="crayon-o">|</span><span class="crayon-v">M</span><span class="crayon-o">|</span><span class="crayon-v">writer</span><span class="crayon-o">|</span><span class="crayon-cn">32067</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d0889e074556468-4">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p>The details are user id, age, gender, occupation and post code. By the way, these details are in the Readme, if you forget.<br />
Again, I will only use the first three enteries (id, age and gender).</p>
<p>Finally, we have <em>u.data</em></p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d088a3421847917" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
196    242    3    881250949
186    302    3    891717742
22    377    1    878887116
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d088a3421847917-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088a3421847917-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d088a3421847917-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088a3421847917-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d088a3421847917-1"><span class="crayon-cn">196</span>  <span class="crayon-h"> </span> <span class="crayon-cn">242</span>  <span class="crayon-h"> </span> <span class="crayon-cn">3</span>  <span class="crayon-h"> </span> <span class="crayon-cn">881250949</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088a3421847917-2"><span class="crayon-cn">186</span>  <span class="crayon-h"> </span> <span class="crayon-cn">302</span>  <span class="crayon-h"> </span> <span class="crayon-cn">3</span>  <span class="crayon-h"> </span> <span class="crayon-cn">891717742</span></div><div class="crayon-line" id="crayon-5bd0ae8d088a3421847917-3"><span class="crayon-cn">22</span>  <span class="crayon-h"> </span> <span class="crayon-cn">377</span>  <span class="crayon-h"> </span> <span class="crayon-cn">1</span>  <span class="crayon-h"> </span> <span class="crayon-cn">878887116</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088a3421847917-4">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p>The entries are user id, movie id, rating and timestamp (which I&#8217;ll ignore in this example).</p>
<p>If you look at the other files, you&#8217;ll see there is a wealth of data. You can draw many conclusions from the data, which is why the dataset is so popular.</p>
<p>We&#8217;ll focus on a small set of the data, mainly on how users of different ages and genders rated movies.</p>
<p><strong>Reading the data</strong></p>
<p>Since the data is plain text separated by <em>|</em>, it will not have column headers like Excel files. Which means, we&#8217;ll have to provide our own, like I did in the first part of the last section.</p>
<p>Pandas has a function to read plain text files, which is a lot similar to numpy&#8217;s read file functions we covered in chapter on plotting (not surprising, since pandas is based in numpy).</p>
<p>On to the code.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d088a8035080086" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
user_columns = ['user_id', 'age', 'sex']

</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d088a8035080086-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088a8035080086-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d088a8035080086-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d088a8035080086-1"><span class="crayon-v">user_columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'user_id'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'age'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'sex'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088a8035080086-2">&nbsp;</div><div class="crayon-line" id="crayon-5bd0ae8d088a8035080086-3">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p>We declare <em>user_columns</em> for the three entries we want to read from <em>u.user</em>. Note that <em>u.user</em> has more than three entries per row, but we will ignore the others.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d088ae708425912" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
users = pd.read_csv('u.user', sep='|', names=user_columns, usecols=range(3))
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d088ae708425912-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088ae708425912-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d088ae708425912-1"><span class="crayon-v">users</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'u.user'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sep</span><span class="crayon-o">=</span><span class="crayon-s">'|'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-o">=</span><span class="crayon-v">user_columns</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">usecols</span><span class="crayon-o">=</span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088ae708425912-2">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p>We will use the <em>read_csv</em> function to read the file, even though it isn&#8217;t technically a csv(comma separated values) file. The first argument is the file name. The second says that our values are separated by <em>|</em>. The third argument merely passes in our <em>user_columns</em> as the column names. The final argument says that we need to only read three values per row. Without this, pandas will try to read the whole line and cause a mess.</p>
<p>In exactly the same way, we load the other values as well:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d088b3590899735" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
rating_columns = ['user_id', 'movie_id', 'rating']
ratings = pd.read_csv('u.data', sep='\t', names=rating_columns,  usecols=range(3))

movie_columns = ['movie_id', 'title']
movies = pd.read_csv('u.item', sep='|', names=movie_columns, usecols=range(2), encoding="iso-8859-1")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d088b3590899735-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088b3590899735-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d088b3590899735-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088b3590899735-4">4</div><div class="crayon-num" data-line="crayon-5bd0ae8d088b3590899735-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d088b3590899735-1"><span class="crayon-v">rating_columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'user_id'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'movie_id'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'rating'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088b3590899735-2"><span class="crayon-v">ratings</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'u.data'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sep</span><span class="crayon-o">=</span><span class="crayon-s">'\t'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-o">=</span><span class="crayon-v">rating_columns</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">usecols</span><span class="crayon-o">=</span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bd0ae8d088b3590899735-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088b3590899735-4"><span class="crayon-v">movie_columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'movie_id'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'title'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5bd0ae8d088b3590899735-5"><span class="crayon-v">movies</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'u.item'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sep</span><span class="crayon-o">=</span><span class="crayon-s">'|'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-o">=</span><span class="crayon-v">movie_columns</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">usecols</span><span class="crayon-o">=</span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">encoding</span><span class="crayon-o">=</span><span class="crayon-s">"iso-8859-1"</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0010 seconds] -->
<p></p>
<p>Now comes the important part. The data in the movielens dataset is spread over multiple files. But that is no good to us. We need to merge it together, so we can analyse it in one go. If you have used Sql, you will know it has a JOIN function to join tables. Pandas has something similar.</p>
<p>Finally, we&#8217;ve added <em><span class="pl-v">encoding</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds"></span>iso-8859-1<span class="pl-pds"></span></span></em>. This is to keep Python 3 happy, as the file contains non-standard characters, and while Python 2 had a W<em>ink wink, I&#8217;ll let you get away with it approach</em>, Python 3 is more strict. We need to make sure we specify that we are using Latin-1 encoding (which is just plain English).</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d088b9755064427" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# create one merged DataFrame
movie_ratings = pd.merge(movies, ratings)
movie_data = pd.merge(movie_ratings, users)
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d088b9755064427-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088b9755064427-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d088b9755064427-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088b9755064427-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d088b9755064427-1"><span class="crayon-p"># create one merged DataFrame</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088b9755064427-2"><span class="crayon-v">movie_ratings</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">merge</span><span class="crayon-sy">(</span><span class="crayon-v">movies</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ratings</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bd0ae8d088b9755064427-3"><span class="crayon-v">movie_data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">merge</span><span class="crayon-sy">(</span><span class="crayon-v">movie_ratings</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">users</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088b9755064427-4">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p>The <em>merge()</em> function will do the same thing. It will take two different DataFrames and merge them together. You can specify an index to merge them on, but pandas is smart enough to find the common index and merge on it.</p>
<p>So for the first merge:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d088be070933092" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
movie_ratings = pd.merge(movies, ratings)
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d088be070933092-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088be070933092-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d088be070933092-1"><span class="crayon-v">movie_ratings</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">merge</span><span class="crayon-sy">(</span><span class="crayon-v">movies</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ratings</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088be070933092-2">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p>pandas will see that <em>movie_id</em> is common between <em>movies</em> and <em>ratings</em>, so will merge on that.</p>
<p>We then merge this newly created <em>movie_ratings</em> with <em>users</em>:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d088c3555516199" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
movie_data = pd.merge(movie_ratings, users)
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d088c3555516199-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088c3555516199-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d088c3555516199-1"><span class="crayon-v">movie_data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">merge</span><span class="crayon-sy">(</span><span class="crayon-v">movie_ratings</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">users</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088c3555516199-2">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p>Again, pandas will figure out <em>user_id</em> is common and merge around that.</p>
<p>The final result is a dataset that contains all the info we need, so we can start working on it.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d088c8511440979" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# Top rated movies
print("Top rated movies (overall):\n"), movie_data.groupby('title').size().sort_values(ascending=False)[:20]
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d088c8511440979-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088c8511440979-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d088c8511440979-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d088c8511440979-1"><span class="crayon-p"># Top rated movies</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088c8511440979-2"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Top rated movies (overall):\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">movie_data</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'title'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">size</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">sort_values</span><span class="crayon-sy">(</span><span class="crayon-v">ascending</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">20</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5bd0ae8d088c8511440979-3">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p>The first thing we are going to do is find movies which have the most ratings. The code above may look big and confusing, but this is actually a feature of Python: You can chain multiple commands. Let&#8217;s break it down.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d088cc146127816" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
movie_data.groupby('title')
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d088cc146127816-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088cc146127816-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d088cc146127816-1"><span class="crayon-v">movie_data</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'title'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088cc146127816-2">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p>The <em>groupby()</em> function allows you to group the data by a chosen column (remember, the data in normally printed by index. Here, we are saying arrange the data by title, not index).</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d088d6384980363" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
movie_data.groupby('title').size()
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d088d6384980363-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088d6384980363-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d088d6384980363-1"><span class="crayon-v">movie_data</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'title'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">size</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088d6384980363-2">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p>After we have the movies by title, we call the <em>size()</em> function to arrange them by size. Normall, this is in ascending order, so:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d088db782867542" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
movie_data.groupby('title').size().sort_values(ascending=False)[:20]
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d088db782867542-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088db782867542-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d088db782867542-1"><span class="crayon-v">movie_data</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'title'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">size</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">sort_values</span><span class="crayon-sy">(</span><span class="crayon-v">ascending</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">20</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088db782867542-2">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p>we call the <em>sort_values(ascending=False)</em> function, which arranged the data in descending order (so movies with more ratings appear at top). Finally, we use <em>[:20]</em> to only show the top 20 movies.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d088e0261303455" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Top rated movies (overall):
title
Star Wars (1977)                    583
Contact (1997)                      509
Fargo (1996)                        508
Return of the Jedi (1983)           507
Liar Liar (1997)                    485
English Patient, The (1996)         481
Scream (1996)                       478
Toy Story (1995)                    452
Air Force One (1997)                431
Independence Day (ID4) (1996)       429
Raiders of the Lost Ark (1981)      420
Godfather, The (1972)               413
Pulp Fiction (1994)                 394
Twelve Monkeys (1995)               392
Silence of the Lambs, The (1991)    390
Jerry Maguire (1996)                384
Chasing Amy (1997)                  379
Rock, The (1996)                    378
Empire Strikes Back, The (1980)     367
Star Trek: First Contact (1996)     365
dtype: int64
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d088e0261303455-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088e0261303455-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d088e0261303455-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088e0261303455-4">4</div><div class="crayon-num" data-line="crayon-5bd0ae8d088e0261303455-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088e0261303455-6">6</div><div class="crayon-num" data-line="crayon-5bd0ae8d088e0261303455-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088e0261303455-8">8</div><div class="crayon-num" data-line="crayon-5bd0ae8d088e0261303455-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088e0261303455-10">10</div><div class="crayon-num" data-line="crayon-5bd0ae8d088e0261303455-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088e0261303455-12">12</div><div class="crayon-num" data-line="crayon-5bd0ae8d088e0261303455-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088e0261303455-14">14</div><div class="crayon-num" data-line="crayon-5bd0ae8d088e0261303455-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088e0261303455-16">16</div><div class="crayon-num" data-line="crayon-5bd0ae8d088e0261303455-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088e0261303455-18">18</div><div class="crayon-num" data-line="crayon-5bd0ae8d088e0261303455-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088e0261303455-20">20</div><div class="crayon-num" data-line="crayon-5bd0ae8d088e0261303455-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088e0261303455-22">22</div><div class="crayon-num" data-line="crayon-5bd0ae8d088e0261303455-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088e0261303455-24">24</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d088e0261303455-1"><span class="crayon-e">Top </span><span class="crayon-e">rated </span><span class="crayon-e">movies</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">overall</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088e0261303455-2"><span class="crayon-e">title</span></div><div class="crayon-line" id="crayon-5bd0ae8d088e0261303455-3"><span class="crayon-e">Star </span><span class="crayon-e">Wars</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1977</span><span class="crayon-sy">)</span>                   <span class="crayon-h"> </span><span class="crayon-cn">583</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088e0261303455-4"><span class="crayon-e">Contact</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1997</span><span class="crayon-sy">)</span>                     <span class="crayon-h"> </span><span class="crayon-cn">509</span></div><div class="crayon-line" id="crayon-5bd0ae8d088e0261303455-5"><span class="crayon-e">Fargo</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1996</span><span class="crayon-sy">)</span>                       <span class="crayon-h"> </span><span class="crayon-cn">508</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088e0261303455-6"><span class="crayon-st">Return</span><span class="crayon-h"> </span><span class="crayon-e">of </span><span class="crayon-e">the </span><span class="crayon-e">Jedi</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1983</span><span class="crayon-sy">)</span>          <span class="crayon-h"> </span><span class="crayon-cn">507</span></div><div class="crayon-line" id="crayon-5bd0ae8d088e0261303455-7"><span class="crayon-e">Liar </span><span class="crayon-e">Liar</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1997</span><span class="crayon-sy">)</span>                   <span class="crayon-h"> </span><span class="crayon-cn">485</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088e0261303455-8"><span class="crayon-e">English </span><span class="crayon-v">Patient</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">The</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1996</span><span class="crayon-sy">)</span>        <span class="crayon-h"> </span><span class="crayon-cn">481</span></div><div class="crayon-line" id="crayon-5bd0ae8d088e0261303455-9"><span class="crayon-e">Scream</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1996</span><span class="crayon-sy">)</span>                      <span class="crayon-h"> </span><span class="crayon-cn">478</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088e0261303455-10"><span class="crayon-e">Toy </span><span class="crayon-e">Story</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1995</span><span class="crayon-sy">)</span>                   <span class="crayon-h"> </span><span class="crayon-cn">452</span></div><div class="crayon-line" id="crayon-5bd0ae8d088e0261303455-11"><span class="crayon-e">Air </span><span class="crayon-e">Force </span><span class="crayon-e">One</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1997</span><span class="crayon-sy">)</span>               <span class="crayon-h"> </span><span class="crayon-cn">431</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088e0261303455-12"><span class="crayon-e">Independence </span><span class="crayon-e">Day</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">ID4</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1996</span><span class="crayon-sy">)</span>      <span class="crayon-h"> </span><span class="crayon-cn">429</span></div><div class="crayon-line" id="crayon-5bd0ae8d088e0261303455-13"><span class="crayon-e">Raiders </span><span class="crayon-e">of </span><span class="crayon-e">the </span><span class="crayon-e">Lost </span><span class="crayon-e">Ark</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1981</span><span class="crayon-sy">)</span>     <span class="crayon-h"> </span><span class="crayon-cn">420</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088e0261303455-14"><span class="crayon-v">Godfather</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">The</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1972</span><span class="crayon-sy">)</span>              <span class="crayon-h"> </span><span class="crayon-cn">413</span></div><div class="crayon-line" id="crayon-5bd0ae8d088e0261303455-15"><span class="crayon-e">Pulp </span><span class="crayon-e">Fiction</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1994</span><span class="crayon-sy">)</span>                <span class="crayon-h"> </span><span class="crayon-cn">394</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088e0261303455-16"><span class="crayon-e">Twelve </span><span class="crayon-e">Monkeys</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1995</span><span class="crayon-sy">)</span>              <span class="crayon-h"> </span><span class="crayon-cn">392</span></div><div class="crayon-line" id="crayon-5bd0ae8d088e0261303455-17"><span class="crayon-e">Silence </span><span class="crayon-e">of </span><span class="crayon-e">the </span><span class="crayon-v">Lambs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">The</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1991</span><span class="crayon-sy">)</span>   <span class="crayon-h"> </span><span class="crayon-cn">390</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088e0261303455-18"><span class="crayon-e">Jerry </span><span class="crayon-e">Maguire</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1996</span><span class="crayon-sy">)</span>               <span class="crayon-h"> </span><span class="crayon-cn">384</span></div><div class="crayon-line" id="crayon-5bd0ae8d088e0261303455-19"><span class="crayon-e">Chasing </span><span class="crayon-e">Amy</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1997</span><span class="crayon-sy">)</span>                 <span class="crayon-h"> </span><span class="crayon-cn">379</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088e0261303455-20"><span class="crayon-v">Rock</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">The</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1996</span><span class="crayon-sy">)</span>                   <span class="crayon-h"> </span><span class="crayon-cn">378</span></div><div class="crayon-line" id="crayon-5bd0ae8d088e0261303455-21"><span class="crayon-e">Empire </span><span class="crayon-e">Strikes </span><span class="crayon-v">Back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">The</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1980</span><span class="crayon-sy">)</span>    <span class="crayon-h"> </span><span class="crayon-cn">367</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088e0261303455-22"><span class="crayon-e">Star </span><span class="crayon-v">Trek</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">First </span><span class="crayon-e">Contact</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1996</span><span class="crayon-sy">)</span>    <span class="crayon-h"> </span><span class="crayon-cn">365</span></div><div class="crayon-line" id="crayon-5bd0ae8d088e0261303455-23"><span class="crayon-v">dtype</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">int64</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088e0261303455-24">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0030 seconds] -->
<p></p>
<p>The second number is the number of votes. So Star Wars has 583 votes, making it the highest rated movie.</p>
<p>To no one&#8217;s surprise, all the Star War movies are there (only the real ones, none of that Jar Jar Binks garbage). Scream and Liar Liar were a bit surprising, as they aren&#8217;t really classics.  But as we&#8217;ll see later, some people may consider them classics.</p>
<p>Let&#8217;s compare how the tastes of teenagers(13-19) vs the oldies (60+) differ.</p>
<p>If you want to see all movies rated by people greater than 60 years, the easiest way is:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d088e6412600422" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
movie_data[movie_data.age &gt; 60]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d088e6412600422-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d088e6412600422-1"><span class="crayon-v">movie_data</span><span class="crayon-sy">[</span><span class="crayon-v">movie_data</span><span class="crayon-sy">.</span><span class="crayon-v">age</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p>&nbsp;</p>
<p>You just pass <em>movie_data.age &gt; 60</em> to itself, and pandas will return a DataFrame which meets this condition. Let&#8217;s do that now:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d088eb265374408" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
oldies = movie_data[(movie_data.age &gt; 60)]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d088eb265374408-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d088eb265374408-1"><span class="crayon-v">oldies</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">movie_data</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-v">movie_data</span><span class="crayon-sy">.</span><span class="crayon-v">age</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p>&nbsp;</p>
<p>This will return the movies sorted by index. We want the movies sorted by number of votes (as above). Let&#8217;s do that now:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d088f0923771295" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# Get the top rated ones
oldies = oldies.groupby('title').size().sort_values(ascending=False)

</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d088f0923771295-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088f0923771295-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d088f0923771295-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088f0923771295-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d088f0923771295-1"><span class="crayon-p"># Get the top rated ones</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088f0923771295-2"><span class="crayon-v">oldies</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">oldies</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'title'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">size</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">sort_values</span><span class="crayon-sy">(</span><span class="crayon-v">ascending</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bd0ae8d088f0923771295-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088f0923771295-4">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p>This is the same code as above, except this time we will see the top rated movies by old people only.</p>
<p>Let&#8217;s do the same for teenagers.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d088f5821417009" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# Extract movies for teens
teens = movie_data[(movie_data.age &gt; 12) &amp; (movie_data.age &lt; 20)]
# Get the top rated ones
teens = teens.groupby('title').size().sort_values(ascending=False)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d088f5821417009-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088f5821417009-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d088f5821417009-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088f5821417009-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d088f5821417009-1"><span class="crayon-p"># Extract movies for teens</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088f5821417009-2"><span class="crayon-v">teens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">movie_data</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-v">movie_data</span><span class="crayon-sy">.</span><span class="crayon-v">age</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">12</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">movie_data</span><span class="crayon-sy">.</span><span class="crayon-v">age</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5bd0ae8d088f5821417009-3"><span class="crayon-p"># Get the top rated ones</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088f5821417009-4"><span class="crayon-v">teens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">teens</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'title'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">size</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">sort_values</span><span class="crayon-sy">(</span><span class="crayon-v">ascending</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p></p>
<p>&nbsp;</p>
<p>I&#8217;m doing the same as above, except this time I have two checks : <em>(movie_data.age &gt; 12) &amp; (movie_data.age &lt; 20)</em>. We can have as many checks as we want. We could have added a <em>movie_data.gender == &#8216;F&#8217;</em> if we wanted teenage girls.</p>
<p>In the next line, again we sort by number of votes.</p>
<p>And now, let&#8217;s print the results, only printing the top 10 results:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d088fa588233821" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
print("Top ten movies for oldies: \n", oldies[:10])
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d088fa588233821-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088fa588233821-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d088fa588233821-1"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Top ten movies for oldies: \n"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">oldies</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">10</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088fa588233821-2">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d088ff799883813" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Top ten movies for oldies:
title
English Patient, The (1996)    17
Fargo (1996)                   12
Full Monty, The (1997)         10
Titanic (1997)                 10
Godfather, The (1972)           9
Seven Years in Tibet (1997)     9
Air Force One (1997)            9
Evita (1996)                    9
L.A. Confidential (1997)        8
Volcano (1997)                  8
dtype: int64
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d088ff799883813-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088ff799883813-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d088ff799883813-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088ff799883813-4">4</div><div class="crayon-num" data-line="crayon-5bd0ae8d088ff799883813-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088ff799883813-6">6</div><div class="crayon-num" data-line="crayon-5bd0ae8d088ff799883813-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088ff799883813-8">8</div><div class="crayon-num" data-line="crayon-5bd0ae8d088ff799883813-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088ff799883813-10">10</div><div class="crayon-num" data-line="crayon-5bd0ae8d088ff799883813-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088ff799883813-12">12</div><div class="crayon-num" data-line="crayon-5bd0ae8d088ff799883813-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d088ff799883813-14">14</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d088ff799883813-1"><span class="crayon-e">Top </span><span class="crayon-e">ten </span><span class="crayon-e">movies </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">oldies</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088ff799883813-2"><span class="crayon-e">title</span></div><div class="crayon-line" id="crayon-5bd0ae8d088ff799883813-3"><span class="crayon-e">English </span><span class="crayon-v">Patient</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">The</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1996</span><span class="crayon-sy">)</span>   <span class="crayon-h"> </span><span class="crayon-cn">17</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088ff799883813-4"><span class="crayon-e">Fargo</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1996</span><span class="crayon-sy">)</span>                  <span class="crayon-h"> </span><span class="crayon-cn">12</span></div><div class="crayon-line" id="crayon-5bd0ae8d088ff799883813-5"><span class="crayon-e">Full </span><span class="crayon-v">Monty</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">The</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1997</span><span class="crayon-sy">)</span>        <span class="crayon-h"> </span><span class="crayon-cn">10</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088ff799883813-6"><span class="crayon-e">Titanic</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1997</span><span class="crayon-sy">)</span>                <span class="crayon-h"> </span><span class="crayon-cn">10</span></div><div class="crayon-line" id="crayon-5bd0ae8d088ff799883813-7"><span class="crayon-v">Godfather</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">The</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1972</span><span class="crayon-sy">)</span>          <span class="crayon-h"> </span><span class="crayon-cn">9</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088ff799883813-8"><span class="crayon-e">Seven </span><span class="crayon-e">Years </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">Tibet</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1997</span><span class="crayon-sy">)</span>    <span class="crayon-h"> </span><span class="crayon-cn">9</span></div><div class="crayon-line" id="crayon-5bd0ae8d088ff799883813-9"><span class="crayon-e">Air </span><span class="crayon-e">Force </span><span class="crayon-e">One</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1997</span><span class="crayon-sy">)</span>           <span class="crayon-h"> </span><span class="crayon-cn">9</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088ff799883813-10"><span class="crayon-e">Evita</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1996</span><span class="crayon-sy">)</span>                   <span class="crayon-h"> </span><span class="crayon-cn">9</span></div><div class="crayon-line" id="crayon-5bd0ae8d088ff799883813-11"><span class="crayon-v">L</span><span class="crayon-sy">.</span><span class="crayon-v">A</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-e">Confidential</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1997</span><span class="crayon-sy">)</span>       <span class="crayon-h"> </span><span class="crayon-cn">8</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088ff799883813-12"><span class="crayon-e">Volcano</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1997</span><span class="crayon-sy">)</span>                 <span class="crayon-h"> </span><span class="crayon-cn">8</span></div><div class="crayon-line" id="crayon-5bd0ae8d088ff799883813-13"><span class="crayon-v">dtype</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">int64</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d088ff799883813-14">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0015 seconds] -->
<p></p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08904724322562" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
print("Top ten movies for teens: \n", teens[:10])
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08904724322562-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08904724322562-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08904724322562-1"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Top ten movies for teens: \n"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">teens</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">10</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08904724322562-2">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08909711882881" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Top ten movies for teens:
Scream (1996)                    65
Contact (1997)                   49
Liar Liar (1997)                 47
Star Wars (1977)                 45
Return of the Jedi (1983)        43
Independence Day (ID4) (1996)    41
Titanic (1997)                   36
Toy Story (1995)                 35
Chasing Amy (1997)               35
Twelve Monkeys (1995)            35

</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08909711882881-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08909711882881-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d08909711882881-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08909711882881-4">4</div><div class="crayon-num" data-line="crayon-5bd0ae8d08909711882881-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08909711882881-6">6</div><div class="crayon-num" data-line="crayon-5bd0ae8d08909711882881-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08909711882881-8">8</div><div class="crayon-num" data-line="crayon-5bd0ae8d08909711882881-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08909711882881-10">10</div><div class="crayon-num" data-line="crayon-5bd0ae8d08909711882881-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08909711882881-12">12</div><div class="crayon-num" data-line="crayon-5bd0ae8d08909711882881-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08909711882881-1"><span class="crayon-e">Top </span><span class="crayon-e">ten </span><span class="crayon-e">movies </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">teens</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08909711882881-2"><span class="crayon-e">Scream</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1996</span><span class="crayon-sy">)</span>                   <span class="crayon-h"> </span><span class="crayon-cn">65</span></div><div class="crayon-line" id="crayon-5bd0ae8d08909711882881-3"><span class="crayon-e">Contact</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1997</span><span class="crayon-sy">)</span>                  <span class="crayon-h"> </span><span class="crayon-cn">49</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08909711882881-4"><span class="crayon-e">Liar </span><span class="crayon-e">Liar</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1997</span><span class="crayon-sy">)</span>                <span class="crayon-h"> </span><span class="crayon-cn">47</span></div><div class="crayon-line" id="crayon-5bd0ae8d08909711882881-5"><span class="crayon-e">Star </span><span class="crayon-e">Wars</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1977</span><span class="crayon-sy">)</span>                <span class="crayon-h"> </span><span class="crayon-cn">45</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08909711882881-6"><span class="crayon-st">Return</span><span class="crayon-h"> </span><span class="crayon-e">of </span><span class="crayon-e">the </span><span class="crayon-e">Jedi</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1983</span><span class="crayon-sy">)</span>       <span class="crayon-h"> </span><span class="crayon-cn">43</span></div><div class="crayon-line" id="crayon-5bd0ae8d08909711882881-7"><span class="crayon-e">Independence </span><span class="crayon-e">Day</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">ID4</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1996</span><span class="crayon-sy">)</span>   <span class="crayon-h"> </span><span class="crayon-cn">41</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08909711882881-8"><span class="crayon-e">Titanic</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1997</span><span class="crayon-sy">)</span>                  <span class="crayon-h"> </span><span class="crayon-cn">36</span></div><div class="crayon-line" id="crayon-5bd0ae8d08909711882881-9"><span class="crayon-e">Toy </span><span class="crayon-e">Story</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1995</span><span class="crayon-sy">)</span>                <span class="crayon-h"> </span><span class="crayon-cn">35</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08909711882881-10"><span class="crayon-e">Chasing </span><span class="crayon-e">Amy</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1997</span><span class="crayon-sy">)</span>              <span class="crayon-h"> </span><span class="crayon-cn">35</span></div><div class="crayon-line" id="crayon-5bd0ae8d08909711882881-11"><span class="crayon-e">Twelve </span><span class="crayon-e">Monkeys</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1995</span><span class="crayon-sy">)</span>           <span class="crayon-h"> </span><span class="crayon-cn">35</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08909711882881-12">&nbsp;</div><div class="crayon-line" id="crayon-5bd0ae8d08909711882881-13">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0014 seconds] -->
<p></p>
<p>You can see that Scream is only liked by teenagers. The English Patient is the older people&#8217;s favourite. But note that it only has 17 votes, which maybe just the fact that there are fewer older people compared to teenagers.</p>
<p>Let&#8217;s now compare the the ratings by gender.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d0890e071959593" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
ratings_by_title = movie_data.groupby('title').size()
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d0890e071959593-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d0890e071959593-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d0890e071959593-1"><span class="crayon-v">ratings_by_title</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">movie_data</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'title'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">size</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d0890e071959593-2">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p>We get the ratings by size.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08913837691938" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
popular_movies = ratings_by_title.index[ratings_by_title &gt;= 250]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08913837691938-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08913837691938-1"><span class="crayon-v">popular_movies</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ratings_by_title</span><span class="crayon-sy">.</span><span class="crayon-v">index</span><span class="crayon-sy">[</span><span class="crayon-v">ratings_by_title</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-cn">250</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p>&nbsp;</p>
<p>We want to avoid movies that have one review. So we are only selecting those movies with at least 250 reviews. This is an arbitrary number. This will help us filter out popular movies only.</p>
<p>The next feature is very powerful. Say you want to reshape a dataset. You could perform multiple select and join operations. But the <em>pivot_table()</em> function allows us to do this more simply. Here, I want to create a new table which has the ratings of the movies selected by gender.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08918539769062" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
ratings_by_gender = movie_data.pivot_table('rating', index='title',columns='gender')
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08918539769062-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08918539769062-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08918539769062-1"><span class="crayon-v">ratings_by_gender</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">movie_data</span><span class="crayon-sy">.</span><span class="crayon-e">pivot_table</span><span class="crayon-sy">(</span><span class="crayon-s">'rating'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-o">=</span><span class="crayon-s">'title'</span><span class="crayon-sy">,</span><span class="crayon-v">columns</span><span class="crayon-o">=</span><span class="crayon-s">'gender'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08918539769062-2">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p>The <em>pivot_table()</em> takes the <em>movie_data</em> and reshapes it. The first argument says we want to arrange it by rating. The second argument says that the index should be the title, and the third says the columns should be based on gender. Let&#8217;s see what we get:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d0891d949509239" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
print("Top rated movies by women \n", top_movies_women.head())

gender                                              F         M
title
'Til There Was You (1997)                    2.200000  2.500000
1-900 (1994)                                 1.000000  3.000000
101 Dalmatians (1996)                        3.116279  2.772727
12 Angry Men (1957)                          4.269231  4.363636
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d0891d949509239-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d0891d949509239-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d0891d949509239-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d0891d949509239-4">4</div><div class="crayon-num" data-line="crayon-5bd0ae8d0891d949509239-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d0891d949509239-6">6</div><div class="crayon-num" data-line="crayon-5bd0ae8d0891d949509239-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d0891d949509239-8">8</div><div class="crayon-num" data-line="crayon-5bd0ae8d0891d949509239-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d0891d949509239-1"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Top rated movies by women \n"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">top_movies_women</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d0891d949509239-2">&nbsp;</div><div class="crayon-line" id="crayon-5bd0ae8d0891d949509239-3"><span class="crayon-i">gender</span>                                             <span class="crayon-h"> </span><span class="crayon-i">F</span>        <span class="crayon-h"> </span><span class="crayon-i">M</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d0891d949509239-4"><span class="crayon-i">title</span></div><div class="crayon-line" id="crayon-5bd0ae8d0891d949509239-5">'<span class="crayon-e">Til </span><span class="crayon-e">There </span><span class="crayon-e">Was </span><span class="crayon-e">You</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1997</span><span class="crayon-sy">)</span>                   <span class="crayon-h"> </span><span class="crayon-cn">2.200000</span> <span class="crayon-h"> </span><span class="crayon-cn">2.500000</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d0891d949509239-6"><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-cn">900</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1994</span><span class="crayon-sy">)</span>                                <span class="crayon-h"> </span><span class="crayon-cn">1.000000</span> <span class="crayon-h"> </span><span class="crayon-cn">3.000000</span></div><div class="crayon-line" id="crayon-5bd0ae8d0891d949509239-7"><span class="crayon-cn">101</span><span class="crayon-h"> </span><span class="crayon-e">Dalmatians</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1996</span><span class="crayon-sy">)</span>                       <span class="crayon-h"> </span><span class="crayon-cn">3.116279</span> <span class="crayon-h"> </span><span class="crayon-cn">2.772727</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d0891d949509239-8"><span class="crayon-cn">12</span><span class="crayon-h"> </span><span class="crayon-e">Angry </span><span class="crayon-e">Men</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1957</span><span class="crayon-sy">)</span>                         <span class="crayon-h"> </span><span class="crayon-cn">4.269231</span> <span class="crayon-h"> </span><span class="crayon-cn">4.363636</span></div><div class="crayon-line" id="crayon-5bd0ae8d0891d949509239-9">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
<p></p>
<p>You can see we have a new table that shows the ratings by gender. But it has a lot of movies that may only have one or two ratings.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08922524128252" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
ratings_by_gender = ratings_by_gender.loc[popular_movies]
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08922524128252-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08922524128252-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08922524128252-1"><span class="crayon-v">ratings_by_gender</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ratings_by_gender</span><span class="crayon-sy">.</span><span class="crayon-v">ix</span><span class="crayon-sy">[</span><span class="crayon-v">popular_movies</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08922524128252-2">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p>The <em>.loc</em> is another way to select data. We are selecting the data that is in <em>popular_movies</em> only, which means it has at least 250 ratings. If I print <em>ratings_by_gender</em> now:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08927994034070" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
gender                               F         M
title
2001: A Space Odyssey (1968)  3.491228  4.103960
Air Force One (1997)          3.690476  3.606557
Alien (1979)                  3.660714  4.123404
Aliens (1986)                 3.672727  4.013100
Amadeus (1984)                4.038961  4.211055
Apollo 13 (1995)              4.000000  3.909953

</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08927994034070-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08927994034070-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d08927994034070-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08927994034070-4">4</div><div class="crayon-num" data-line="crayon-5bd0ae8d08927994034070-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08927994034070-6">6</div><div class="crayon-num" data-line="crayon-5bd0ae8d08927994034070-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08927994034070-8">8</div><div class="crayon-num" data-line="crayon-5bd0ae8d08927994034070-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08927994034070-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08927994034070-1"><span class="crayon-i">gender</span>                              <span class="crayon-h"> </span><span class="crayon-i">F</span>        <span class="crayon-h"> </span><span class="crayon-i">M</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08927994034070-2"><span class="crayon-i">title</span></div><div class="crayon-line" id="crayon-5bd0ae8d08927994034070-3"><span class="crayon-cn">2001</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">A</span><span class="crayon-h"> </span><span class="crayon-e">Space </span><span class="crayon-e">Odyssey</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1968</span><span class="crayon-sy">)</span> <span class="crayon-h"> </span><span class="crayon-cn">3.491228</span> <span class="crayon-h"> </span><span class="crayon-cn">4.103960</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08927994034070-4"><span class="crayon-e">Air </span><span class="crayon-e">Force </span><span class="crayon-e">One</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1997</span><span class="crayon-sy">)</span>         <span class="crayon-h"> </span><span class="crayon-cn">3.690476</span> <span class="crayon-h"> </span><span class="crayon-cn">3.606557</span></div><div class="crayon-line" id="crayon-5bd0ae8d08927994034070-5"><span class="crayon-e">Alien</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1979</span><span class="crayon-sy">)</span>                 <span class="crayon-h"> </span><span class="crayon-cn">3.660714</span> <span class="crayon-h"> </span><span class="crayon-cn">4.123404</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08927994034070-6"><span class="crayon-e">Aliens</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1986</span><span class="crayon-sy">)</span>                <span class="crayon-h"> </span><span class="crayon-cn">3.672727</span> <span class="crayon-h"> </span><span class="crayon-cn">4.013100</span></div><div class="crayon-line" id="crayon-5bd0ae8d08927994034070-7"><span class="crayon-e">Amadeus</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1984</span><span class="crayon-sy">)</span>               <span class="crayon-h"> </span><span class="crayon-cn">4.038961</span> <span class="crayon-h"> </span><span class="crayon-cn">4.211055</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08927994034070-8"><span class="crayon-i">Apollo</span><span class="crayon-h"> </span><span class="crayon-cn">13</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1995</span><span class="crayon-sy">)</span>             <span class="crayon-h"> </span><span class="crayon-cn">4.000000</span> <span class="crayon-h"> </span><span class="crayon-cn">3.909953</span></div><div class="crayon-line" id="crayon-5bd0ae8d08927994034070-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08927994034070-10">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
<p></p>
<p>That&#8217;s better. We are getting movies we&#8217;ve heard of.</p>
<p>Let&#8217;s see which movies were top rated by women:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d0892c994724246" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
top_movies_women = ratings_by_gender.sort_values(by='F', ascending=False)
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d0892c994724246-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d0892c994724246-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d0892c994724246-1"><span class="crayon-v">top_movies_women</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ratings_by_gender</span><span class="crayon-sy">.</span><span class="crayon-e">sort_values</span><span class="crayon-sy">(</span><span class="crayon-v">by</span><span class="crayon-o">=</span><span class="crayon-s">'F'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ascending</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d0892c994724246-2">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p>You should understand what&#8217;s going on by now. We are sorting <em>ratings_by_gender</em> by the &#8216;F&#8217; column, which remember, stands for female. Let&#8217;s print that:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08931135951171" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
print("Top rated movies by women \n", top_movies_women.head())
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08931135951171-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08931135951171-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08931135951171-1"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Top rated movies by women \n"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">top_movies_women</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08931135951171-2">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08935940035271" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Top rated movies by women

gender                                         F         M
title
Schindler's List (1993)                 4.632911  4.406393
Shawshank Redemption, The (1994)        4.562500  4.410959
Usual Suspects, The (1995)              4.333333  4.399061
Silence of the Lambs, The (1991)        4.320000  4.279310
Titanic (1997)                          4.278846  4.231707
Sense and Sensibility (1995)            4.252632  3.878613
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08935940035271-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08935940035271-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d08935940035271-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08935940035271-4">4</div><div class="crayon-num" data-line="crayon-5bd0ae8d08935940035271-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08935940035271-6">6</div><div class="crayon-num" data-line="crayon-5bd0ae8d08935940035271-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08935940035271-8">8</div><div class="crayon-num" data-line="crayon-5bd0ae8d08935940035271-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08935940035271-10">10</div><div class="crayon-num" data-line="crayon-5bd0ae8d08935940035271-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08935940035271-1"><span class="crayon-e">Top </span><span class="crayon-e">rated </span><span class="crayon-e">movies </span><span class="crayon-e">by </span><span class="crayon-e">women</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08935940035271-2">&nbsp;</div><div class="crayon-line" id="crayon-5bd0ae8d08935940035271-3"><span class="crayon-i">gender</span>                                        <span class="crayon-h"> </span><span class="crayon-i">F</span>        <span class="crayon-h"> </span><span class="crayon-i">M</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08935940035271-4"><span class="crayon-e">title</span></div><div class="crayon-line" id="crayon-5bd0ae8d08935940035271-5"><span class="crayon-i">Schindler</span>'<span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-e">List</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1993</span><span class="crayon-sy">)</span>                <span class="crayon-h"> </span><span class="crayon-cn">4.632911</span> <span class="crayon-h"> </span><span class="crayon-cn">4.406393</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08935940035271-6"><span class="crayon-e">Shawshank </span><span class="crayon-v">Redemption</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">The</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1994</span><span class="crayon-sy">)</span>       <span class="crayon-h"> </span><span class="crayon-cn">4.562500</span> <span class="crayon-h"> </span><span class="crayon-cn">4.410959</span></div><div class="crayon-line" id="crayon-5bd0ae8d08935940035271-7"><span class="crayon-e">Usual </span><span class="crayon-v">Suspects</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">The</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1995</span><span class="crayon-sy">)</span>             <span class="crayon-h"> </span><span class="crayon-cn">4.333333</span> <span class="crayon-h"> </span><span class="crayon-cn">4.399061</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08935940035271-8"><span class="crayon-e">Silence </span><span class="crayon-e">of </span><span class="crayon-e">the </span><span class="crayon-v">Lambs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">The</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1991</span><span class="crayon-sy">)</span>       <span class="crayon-h"> </span><span class="crayon-cn">4.320000</span> <span class="crayon-h"> </span><span class="crayon-cn">4.279310</span></div><div class="crayon-line" id="crayon-5bd0ae8d08935940035271-9"><span class="crayon-e">Titanic</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1997</span><span class="crayon-sy">)</span>                         <span class="crayon-h"> </span><span class="crayon-cn">4.278846</span> <span class="crayon-h"> </span><span class="crayon-cn">4.231707</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08935940035271-10"><span class="crayon-e">Sense </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-e">Sensibility</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1995</span><span class="crayon-sy">)</span>           <span class="crayon-h"> </span><span class="crayon-cn">4.252632</span> <span class="crayon-h"> </span><span class="crayon-cn">3.878613</span></div><div class="crayon-line" id="crayon-5bd0ae8d08935940035271-11">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0014 seconds] -->
<p></p>
<p>As you can see, most top rated movies by women also got high ratings by men. Except for the last one, <em>Sense and Sensibility (1995)</em>. Are there other movies men and women disagree on?</p>
<p>We are going to add a new column to our table, which will calculate the difference between the men and women&#8217;s ratings:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d0893a092603566" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
ratings_by_gender['diff'] = ratings_by_gender['M'] - ratings_by_gender['F']
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d0893a092603566-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d0893a092603566-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d0893a092603566-1"><span class="crayon-v">ratings_by_gender</span><span class="crayon-sy">[</span><span class="crayon-s">'diff'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ratings_by_gender</span><span class="crayon-sy">[</span><span class="crayon-s">'M'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">ratings_by_gender</span><span class="crayon-sy">[</span><span class="crayon-s">'F'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d0893a092603566-2">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p>Here, <em>diff</em> is a new column. This is what it will look like:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08940190773922" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
print("Difference by gender \n", ratings_by_gender.head())
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08940190773922-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08940190773922-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08940190773922-1"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Difference by gender \n"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ratings_by_gender</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08940190773922-2">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08944022752696" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Difference by gender

gender                               F         M      diff
title
2001: A Space Odyssey (1968)  3.491228  4.103960  0.612732
Air Force One (1997)          3.690476  3.606557 -0.083919
Alien (1979)                  3.660714  4.123404  0.462690
Aliens (1986)                 3.672727  4.013100  0.340373

</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08944022752696-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08944022752696-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d08944022752696-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08944022752696-4">4</div><div class="crayon-num" data-line="crayon-5bd0ae8d08944022752696-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08944022752696-6">6</div><div class="crayon-num" data-line="crayon-5bd0ae8d08944022752696-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08944022752696-8">8</div><div class="crayon-num" data-line="crayon-5bd0ae8d08944022752696-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08944022752696-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08944022752696-1"><span class="crayon-e">Difference </span><span class="crayon-e">by </span><span class="crayon-e">gender</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08944022752696-2">&nbsp;</div><div class="crayon-line" id="crayon-5bd0ae8d08944022752696-3"><span class="crayon-i">gender</span>                              <span class="crayon-h"> </span><span class="crayon-i">F</span>        <span class="crayon-h"> </span><span class="crayon-i">M</span>     <span class="crayon-h"> </span><span class="crayon-e">diff</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08944022752696-4"><span class="crayon-i">title</span></div><div class="crayon-line" id="crayon-5bd0ae8d08944022752696-5"><span class="crayon-cn">2001</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">A</span><span class="crayon-h"> </span><span class="crayon-e">Space </span><span class="crayon-e">Odyssey</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1968</span><span class="crayon-sy">)</span> <span class="crayon-h"> </span><span class="crayon-cn">3.491228</span> <span class="crayon-h"> </span><span class="crayon-cn">4.103960</span> <span class="crayon-h"> </span><span class="crayon-cn">0.612732</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08944022752696-6"><span class="crayon-e">Air </span><span class="crayon-e">Force </span><span class="crayon-e">One</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1997</span><span class="crayon-sy">)</span>         <span class="crayon-h"> </span><span class="crayon-cn">3.690476</span> <span class="crayon-h"> </span><span class="crayon-cn">3.606557</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">0.083919</span></div><div class="crayon-line" id="crayon-5bd0ae8d08944022752696-7"><span class="crayon-e">Alien</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1979</span><span class="crayon-sy">)</span>                 <span class="crayon-h"> </span><span class="crayon-cn">3.660714</span> <span class="crayon-h"> </span><span class="crayon-cn">4.123404</span> <span class="crayon-h"> </span><span class="crayon-cn">0.462690</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08944022752696-8"><span class="crayon-e">Aliens</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1986</span><span class="crayon-sy">)</span>                <span class="crayon-h"> </span><span class="crayon-cn">3.672727</span> <span class="crayon-h"> </span><span class="crayon-cn">4.013100</span> <span class="crayon-h"> </span><span class="crayon-cn">0.340373</span></div><div class="crayon-line" id="crayon-5bd0ae8d08944022752696-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08944022752696-10">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p></p>
<p>Now, we want to see which movies had the greatest difference in votes. After I wrote this code, I saw Wes McKinney&#8217;s book on Pandas (Wes wrote the Pandas library), and he too used this example. He used standard deviation, which I guess will give a more accurate answer. I use the simple absolute value (the absolute value of the <em>diff</em> parameter we created).</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08949158098131" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
gender_diff = ratings_by_gender['diff']
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08949158098131-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08949158098131-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08949158098131-1"><span class="crayon-v">gender_diff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ratings_by_gender</span><span class="crayon-sy">[</span><span class="crayon-s">'diff'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08949158098131-2">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p>I store just the differences in a new DataFrame.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d0894e844813847" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# Only get absolute values
gender_diff = abs(gender_diff)
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d0894e844813847-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d0894e844813847-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d0894e844813847-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d0894e844813847-1"><span class="crayon-p"># Only get absolute values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d0894e844813847-2"><span class="crayon-v">gender_diff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">abs</span><span class="crayon-sy">(</span><span class="crayon-v">gender_diff</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bd0ae8d0894e844813847-3">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p>And get the absolute values, to remove the negative sign.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08953395437029" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
#Sort by size
gender_diff.sort_values(inplace=True, ascending = False)
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08953395437029-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08953395437029-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d08953395437029-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08953395437029-1"><span class="crayon-p">#Sort by size</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08953395437029-2"><span class="crayon-v">gender_diff</span><span class="crayon-sy">.</span><span class="crayon-e">sort_values</span><span class="crayon-sy">(</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ascending</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bd0ae8d08953395437029-3">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p>Sort it by descending size, so the biggest differences will show up on top. And finally, we graph it:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5bd0ae8d08958859084361" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# Show top 10 differences

gender_diff[:10].plot(kind='barh')
plt.show()
</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums" data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5bd0ae8d08958859084361-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08958859084361-2">2</div><div class="crayon-num" data-line="crayon-5bd0ae8d08958859084361-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5bd0ae8d08958859084361-4">4</div><div class="crayon-num" data-line="crayon-5bd0ae8d08958859084361-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5bd0ae8d08958859084361-1"><span class="crayon-p"># Show top 10 differences</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08958859084361-2">&nbsp;</div><div class="crayon-line" id="crayon-5bd0ae8d08958859084361-3"><span class="crayon-v">gender_diff</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">10</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">kind</span><span class="crayon-o">=</span><span class="crayon-s">'barh'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5bd0ae8d08958859084361-4"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5bd0ae8d08958859084361-5">&nbsp;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p>The barh is a type of bar graph, except it is drawn in the horizontal direction:</p>
<p><img src="/wp-content/uploads/2017/04/pandas6.png" alt="" class="aligncenter wp-image-3015" width="1043" height="281" srcset="/wp-content/uploads/2017/04/pandas6.png 2044w, /wp-content/uploads/2017/04/pandas6-300x81.png 300w, /wp-content/uploads/2017/04/pandas6-768x207.png 768w, /wp-content/uploads/2017/04/pandas6-1024x276.png 1024w, /wp-content/uploads/2017/04/pandas6-1200x323.png 1200w" sizes="(max-width: 709px) 85vw, (max-width: 909px) 67vw, (max-width: 1362px) 62vw, 840px" /></p>
<h2>Conclusion</h2>
<p>That was a quick intro to Pandas. My advice is, search for some open data (just Google open data. Many countries, like the UK and USA, put a lot of their government data online for free) and find something you like. Pandas is quite easy to use, and there is a lot of help online. Any time you get stuck, just Google it.</p>
	</div><!-- .entry-content -->

	
</article><!-- #post-## -->

	</main><!-- .site-main -->

	
</div><!-- .content-area -->


	<aside id="secondary" class="sidebar widget-area" role="complementary">
		<section id="search-4" class="widget widget_search">
<form role="search" method="get" class="search-form" action="/">
	<label>
		<span class="screen-reader-text">Search for:</span>
		<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
	</label>
	<button type="submit" class="search-submit"><span class="screen-reader-text">Search</span></button>
</form>
</section><section id="text-4" class="widget widget_text"><h2 class="widget-title">WARNING</h2>			<div class="textwidget"><p>This site is now in maintenance mode. <a href="/maintenance-mode/">Please see here for details</a></p>
<p>&nbsp;</p>
<p><strong>Tldr</strong>: I am no longer working actively on the site, though I will keep it online as it is still helping a lot of people.</p>
</div>
		</section>	</aside><!-- .sidebar .widget-area -->

		</div><!-- .site-content -->

		<footer id="colophon" class="site-footer" role="contentinfo">
							<nav class="main-navigation" role="navigation" aria-label="Footer Primary Menu">
					<div class="menu-main-container"><ul id="menu-main-1" class="primary-menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-52"><a href="/articles/">Articles</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1533"><a href="/about/">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35"><a href="/contact/">Contact</a></li>
</ul></div>				</nav><!-- .main-navigation -->
			
			
			<div class="site-info">
								<span class="site-title"><a href="/" rel="home">Python For Engineers</a></span>
								<a href="https://wordpress.org/" class="imprint">
					Proudly powered by WordPress				</a>
			</div><!-- .site-info -->
		</footer><!-- .site-footer -->
	</div><!-- .site-inner -->
</div><!-- .site -->

<script type='text/javascript' src='/wp-content/themes/twentysixteen/js/skip-link-focus-fix.js?ver=20160816'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var screenReaderText = {"expand":"expand child menu","collapse":"collapse child menu"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/themes/twentysixteen/js/functions.js?ver=20160816'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var tve_dash_front = {"ajaxurl":"http:\/\/pythonforengineers.com\/wp-admin\/admin-ajax.php","force_ajax_send":"","is_crawler":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/thrive-visual-editor/thrive-dashboard/js/dist/frontend.min.js?ver=2.0.45'></script>
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.9.8'></script>
</body>
</html>
